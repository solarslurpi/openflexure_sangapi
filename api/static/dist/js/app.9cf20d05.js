(function(t){function e(e){for(var i,n,o=e[0],l=e[1],u=e[2],c=0,d=[];c<o.length;c++)n=o[c],Object.prototype.hasOwnProperty.call(s,n)&&s[n]&&d.push(s[n][0]),s[n]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);m&&m(e);while(d.length)d.shift()();return r.push.apply(r,u||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],i=!0,n=1;n<a.length;n++){var o=a[n];0!==s[o]&&(i=!1)}i&&(r.splice(e--,1),t=l(l.s=a[0]))}return t}var i={},n={app:0},s={app:0},r=[];function o(t){return l.p+"js/"+({imjoy:"imjoy"}[t]||t)+"."+{imjoy:"1cb08970"}[t]+".js"}function l(e){if(i[e])return i[e].exports;var a=i[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,l),a.l=!0,a.exports}l.e=function(t){var e=[],a={imjoy:1};n[t]?e.push(n[t]):0!==n[t]&&a[t]&&e.push(n[t]=new Promise((function(e,a){for(var i="css/"+({imjoy:"imjoy"}[t]||t)+"."+{imjoy:"a217f085"}[t]+".css",s=l.p+i,r=document.getElementsByTagName("link"),o=0;o<r.length;o++){var u=r[o],c=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(c===i||c===s))return e()}var d=document.getElementsByTagName("style");for(o=0;o<d.length;o++){u=d[o],c=u.getAttribute("data-href");if(c===i||c===s)return e()}var m=document.createElement("link");m.rel="stylesheet",m.type="text/css",m.onload=e,m.onerror=function(e){var i=e&&e.target&&e.target.src||s,r=new Error("Loading CSS chunk "+t+" failed.\n("+i+")");r.code="CSS_CHUNK_LOAD_FAILED",r.request=i,delete n[t],m.parentNode.removeChild(m),a(r)},m.href=s;var p=document.getElementsByTagName("head")[0];p.appendChild(m)})).then((function(){n[t]=0})));var i=s[t];if(0!==i)if(i)e.push(i[2]);else{var r=new Promise((function(e,a){i=s[t]=[e,a]}));e.push(i[2]=r);var u,c=document.createElement("script");c.charset="utf-8",c.timeout=120,l.nc&&c.setAttribute("nonce",l.nc),c.src=o(t);var d=new Error;u=function(e){c.onerror=c.onload=null,clearTimeout(m);var a=s[t];if(0!==a){if(a){var i=e&&("load"===e.type?"missing":e.type),n=e&&e.target&&e.target.src;d.message="Loading chunk "+t+" failed.\n("+i+": "+n+")",d.name="ChunkLoadError",d.type=i,d.request=n,a[1](d)}s[t]=void 0}};var m=setTimeout((function(){u({type:"timeout",target:c})}),12e4);c.onerror=c.onload=u,document.head.appendChild(c)}return Promise.all(e)},l.m=t,l.c=i,l.d=function(t,e,a){l.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},l.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.t=function(t,e){if(1&e&&(t=l(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(l.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)l.d(a,i,function(e){return t[e]}.bind(null,i));return a},l.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return l.d(e,"a",e),e},l.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},l.p="/",l.oe=function(t){throw console.error(t),t};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],c=u.push.bind(u);u.push=e,u=u.slice();for(var d=0;d<u.length;d++)e(u[d]);var m=c;r.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"04f3":function(t,e,a){},"0a08":function(t,e,a){},"0e41":function(t,e,a){"use strict";a("6d79")},"140f":function(t,e,a){"use strict";a("bacb")},"166c":function(t,e,a){},"1aef":function(t,e,a){},2395:function(t,e,a){},"25c5":function(t,e,a){"use strict";a("04f3")},3588:function(t,e,a){"use strict";a("9398")},4088:function(t,e,a){"use strict";a("1aef")},4529:function(t,e,a){"use strict";a("e324")},"4f3e":function(t,e,a){"use strict";a("716d")},"500b":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("form",{on:{submit:function(e){return e.preventDefault(),t.handleMetadataSubmit(e)}}},[a("div",{staticClass:"uk-margin-remove uk-flex uk-flex-middle"},[a("div",{staticClass:"uk-margin-remove-top uk-padding-remove uk-grid-small uk-width-expand",attrs:{"uk-grid":""}},[a("div",{staticClass:"uk-margin-remove uk-width-1-2"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.newMetadata.key,expression:"newMetadata.key"}],ref:"textboxKey",staticClass:"uk-input uk-form-width-small uk-form-small",attrs:{type:"text",name:"flavor",placeholder:"Key"},domProps:{value:t.newMetadata.key},on:{input:function(e){e.target.composing||t.$set(t.newMetadata,"key",e.target.value)}}})]),a("div",{staticClass:"uk-margin-remove uk-width-1-2"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.newMetadata.value,expression:"newMetadata.value"}],staticClass:"uk-input uk-form-width-small uk-form-small",attrs:{type:"text",name:"flavor",placeholder:"Value"},domProps:{value:t.newMetadata.value},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleMetadataSubmit()},input:function(e){e.target.composing||t.$set(t.newMetadata,"value",e.target.value)}}})])]),a("a",{staticClass:"uk-icon uk-margin-left",attrs:{href:"#"},on:{click:function(e){return t.handleMetadataSubmit()}}},[a("i",{staticClass:"material-icons"},[t._v("add_circle")])])])]),t._l(t.value,(function(e,i){return a("div",{key:i,staticClass:"uk-width-1-1 uk-margin-small uk-margin-remove-left uk-margin-remove-right uk-flex uk-flex-middle"},[a("div",{staticClass:"uk-margin-remove-top uk-padding-remove uk-width-expand"},[a("labelInput",{attrs:{name:i,label:i,value:t.value[i]},on:{input:function(e){t.value[i]=e}}})],1),a("a",{staticClass:"uk-icon uk-width-auto",attrs:{href:"#"},on:{click:function(e){return t.delMetadataKey(i)}}},[a("i",{staticClass:"material-icons"},[t._v("delete")])])])}))],2)},n=[],s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("label",{staticClass:"uk-form-label uk-text-bold"},[t._v(t._s(t.label))]),a("div",{attrs:{"uk-tooltip":"title: Click to edit value; delay: 250"},on:{click:function(e){return t.setEditing(!0)}}},[a("div",{directives:[{name:"show",rawName:"v-show",value:0==t.editing,expression:"editing == false"}]},[a("label",[t._v(" "+t._s(t.value)+" ")])]),a("input",{directives:[{name:"show",rawName:"v-show",value:1==t.editing,expression:"editing == true"}],ref:"textinput",staticClass:"uk-input uk-form-small",attrs:{type:"text",name:t.name,autofocus:""},domProps:{value:t.value},on:{blur:function(e){return t.setEditing(!1)},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.setEditing(!1)},input:function(e){return t.$emit("input",e.target.value)}}})])])},r=[],o={name:"LabelInput",props:{label:{type:String,required:!0},name:{type:String,required:!0},value:{type:String,required:!0}},data:function(){return{editing:!1}},methods:{setEditing:function(t){var e=this;this.editing=t,1==t&&this.$nextTick((function(){return e.$refs.textinput.focus()}))}}},l=o,u=a("2877"),c=Object(u["a"])(l,s,r,!1,null,"2cadff83",null),d=c.exports,m={name:"KeyvalList",components:{labelInput:d},props:{value:{type:Object,required:!0}},data:function(){return{newMetadata:{key:"",value:""}}},methods:{handleMetadataSubmit:function(){var t={};null!=this.value&&Object.assign(t,this.value),t[this.newMetadata.key]=this.newMetadata.value,this.newMetadata.key="",this.newMetadata.value="",this.$emit("input",t),this.$refs.textboxKey&&this.$refs.textboxKey.focus()},delMetadataKey:function(t){var e={};null!=this.value&&Object.assign(e,this.value),this.$delete(e,t),this.$emit("input",e)}}},p=m,v=Object(u["a"])(p,i,n,!1,null,"55e4fc94",null);e["a"]=v.exports},"56d7":function(t,e,a){"use strict";a.r(e);a("cadf"),a("551c"),a("f751"),a("097d");var i=a("2b0e"),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"uk-height-1-1 uk-margin-remove uk-padding-remove",class:t.handleTheme,attrs:{id:"app"}},[t.$store.getters.ready?t._e():a("loadingContent"),t.$store.getters.ready?a("div",{attrs:{id:"tour-header"}}):t._e(),t.$store.getters.ready?a("appContent"):t._e(),a("div",{ref:"keyboardManualModal",staticClass:"uk-flex-top",attrs:{id:"modal-center","uk-modal":""}},[a("div",{staticClass:"uk-modal-dialog uk-modal-body uk-margin-auto-vertical"},[a("button",{staticClass:"uk-modal-close-default",attrs:{type:"button","uk-close":""}}),t._l(t.keyboardManual,(function(e){return a("div",{key:e.shortcut,staticClass:"uk-margin-small",attrs:{"uk-grid":""}},[a("div",{staticClass:"uk-width-small"},[t._v(t._s(e.shortcut))]),a("div",{staticClass:"uk-width-expand"},[t._v(t._s(e.description))])])}))],2)]),a("v-tour",{directives:[{name:"show",rawName:"v-show",value:t.$store.getters.ready,expression:"$store.getters.ready"}],attrs:{name:"guidedTour",steps:t.tourSteps,callbacks:t.tourCallbacks,options:{highlight:!0}}})],1)},s=[],r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"uk-margin-remove uk-padding-remove uk-height-1-1",attrs:{id:"app-content","uk-grid":""}},[a("calibrationModal",{ref:"calibrationModal",attrs:{"available-plugins":t.plugins},on:{onClose:function(e){return t.enterApp()}}}),a("div",{attrs:{id:"switcher-left-container"}},[a("div",{staticClass:"uk-flex uk-flex-column uk-padding-remove uk-width-auto uk-height-1-1 uk-text-center",attrs:{id:"switcher-left"}},[t._l(t.topTabs,(function(e,i){return[a("tabIcon",{key:e.id+"-tab-icon",class:e.class,attrs:{id:e.id+"-tab-icon","tab-i-d":e.id,"require-connection":!0,"current-tab":t.currentTab},on:{"set-tab":t.setTab}},[e.iconURL?a("img",{staticStyle:{filter:"grayscale(100%)",width:"22px","margin-top":"5px","margin-bottom":"8px"},attrs:{src:e.iconURL}}):t._e(),e.iconURL?t._e():a("i",{staticClass:"material-icons"},[t._v(" "+t._s(e.icon)+" ")])]),e.divide?a("hr",{key:"tab-divider-"+i}):t._e()]})),t._l(t.pluginsGuiList,(function(e){return a("tabIcon",{key:e.id,attrs:{"tab-i-d":e.id,title:e.title,"require-connection":e.requiresConnection,"current-tab":t.currentTab,"click-callback":t.updatePlugins},on:{"set-tab":t.setTab}},[a("i",{staticClass:"material-icons"},[t._v(t._s(e.icon||"extension"))])])})),t._l(t.imjoyTabs,(function(e){return a("tabIcon",{key:e.id,attrs:{"tab-i-d":"ImJoy-Plugin-"+e.id,title:e.name,"require-connection":!1,"current-tab":t.currentTab},on:{"set-tab":t.setTab}},[e.iconURL?a("img",{staticStyle:{filter:"grayscale(100%)",width:"22px","margin-top":"5px","margin-bottom":"8px"},attrs:{src:e.iconURL}}):t._e(),e.iconURL?t._e():a("i",{staticClass:"material-icons"},[t._v(" "+t._s(e.iconName||"extension")+" ")])])})),a("hr",{attrs:{id:"extension-tab-divider"}}),t._l(t.bottomTabs,(function(e,i){return[a("tabIcon",{key:e.id+"-tab-icon",class:e.class,attrs:{id:e.id+"-tab-icon","tab-i-d":e.id,"require-connection":!0,"current-tab":t.currentTab},on:{"set-tab":t.setTab}},[a("i",{staticClass:"material-icons"},[t._v(t._s(e.icon))])]),e.divide?a("hr",{key:"tab-divider-"+i}):t._e()]}))],2)]),a("div",{staticClass:"uk-padding-remove uk-height-1-1 uk-width-expand",attrs:{id:"container-left"}},[t._l(t.topTabs,(function(e){return a("tabContent",{key:e.id+"-tab-content",attrs:{id:e.id+"-tab-content","tab-i-d":e.id,"require-connection":!0,"current-tab":t.currentTab}},[a(e.component,{tag:"component"})],1)})),t._l(t.pluginsGuiList,(function(e){return a("tabContent",{key:e.id,attrs:{"tab-i-d":e.id,"require-connection":e.requiresConnection,"current-tab":t.currentTab}},[a("extensionContent",{attrs:{forms:e.forms,frame:e.frame,"web-component":e.wc,"view-panel":e.viewPanel},on:{reloadForms:function(e){return t.updatePlugins()}}})],1)})),t._l(t.imjoyTabs,(function(e){return a("tabContent",{key:e.id,attrs:{"tab-i-d":"ImJoy-Plugin-"+e.id,"require-connection":!1,"current-tab":t.currentTab}},[a("div",{staticClass:"window-container",attrs:{id:e.window_id}},[t._v("Loading...")])])})),t._l(t.bottomTabs,(function(e){return a("tabContent",{key:e.id+"-tab-content",attrs:{id:e.id+"-tab-content","tab-i-d":e.id,"require-connection":!0,"current-tab":t.currentTab}},[a(e.component,{tag:"component"})],1)}))],2)],1)},o=[],l=(a("8e6e"),a("456d"),a("ac4d"),a("8a81"),a("ac6a"),a("8615"),a("bd86")),u=a("bc3a"),c=a.n(u),d=a("2f62"),m=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a",{staticClass:"uk-link",class:t.classObject,attrs:{href:"#","uk-tooltip":t.tooltipOptions},on:{click:t.setThisTab}},[t._t("default"),t.showTitle?a("div",{staticClass:"tabtitle"},[t._v(" "+t._s(t.computedTitle)+" ")]):t._e()],2)},p=[],v=(a("28a5"),{name:"TabIcon",props:{tabID:{type:String,required:!0},title:{type:String,required:!1,default:void 0},showTitle:{type:Boolean,required:!1,default:!0},showTooltip:{type:Boolean,required:!1,default:!0},currentTab:{type:String,required:!0},clickCallback:{type:Function,required:!1,default:null},requireConnection:Boolean},computed:{computedTitle:function(){if(void 0!==this.title)return this.title;var t=this.tabID.split(".").pop();return t.charAt(0).toUpperCase()+t.slice(1)},tooltipOptions:function(){return!!this.showTooltip&&"pos: right; title: ".concat(this.computedTitle,"; delay: 500")},classObject:function(){return{"tabicon-active":this.currentTab==this.tabID,"uk-disabled":this.requireConnection&&!this.$store.getters.ready}}},methods:{setThisTab:function(t){this.$emit("set-tab",t,this.tabID),this.clickCallback&&this.clickCallback()}}}),f=v,h=(a("3588"),a("2877")),g=Object(h["a"])(f,m,p,!1,null,"40897648",null),b=g.exports,k=function(){var t=this,e=t.$createElement,a=t._self._c||e;return!t.requireConnection||t.$store.getters.ready?a("div",{staticClass:"uk-width-expand uk-height-1-1",attrs:{hidden:t.currentTab!=t.tabID}},[t._t("default")],2):t._e()},y=[],_={name:"TabContent",props:{tabID:{type:String,required:!0},currentTab:{type:String,required:!0},requireConnection:Boolean},computed:{},methods:{}},w=_,C=(a("5cd7"),Object(h["a"])(w,k,y,!1,null,"5aad8e04",null)),S=C.exports,x=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"uk-height-1-1 uk-margin-remove uk-padding-remove",attrs:{"uk-grid":""}},[a("div",{staticClass:"control-component"},[a("paneNavigate")],1),a("div",{staticClass:"view-component uk-width-expand"},[a("streamDisplay")],1)])},$=[],T=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"uk-padding-small",attrs:{id:"paneNavigate"}},[t.setPosition?a("div",[a("ul",{attrs:{"uk-accordion":"multiple: true"}},[a("li",[a("a",{staticClass:"uk-accordion-title",attrs:{href:"#"}},[t._v("Configure")]),a("div",{staticClass:"uk-accordion-content"},[a("b",[t._v("STEP SIZE")]),a("div",{staticClass:"uk-grid-small uk-child-width-1-3",attrs:{"uk-grid":""}},[a("div",[a("label",{staticClass:"uk-form-label",attrs:{for:"form-stacked-text"}},[t._v("x")]),a("div",{staticClass:"uk-form-controls"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.stepSize.x,expression:"stepSize.x"}],staticClass:"uk-input uk-form-small",attrs:{type:"number",name:"inputStepXy"},domProps:{value:t.stepSize.x},on:{input:function(e){e.target.composing||t.$set(t.stepSize,"x",e.target.value)}}})]),a("label",{staticClass:"uk-margin-small-right"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.invert.x,expression:"invert.x"}],staticClass:"uk-checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.invert.x)?t._i(t.invert.x,null)>-1:t.invert.x},on:{change:function(e){var a=t.invert.x,i=e.target,n=!!i.checked;if(Array.isArray(a)){var s=null,r=t._i(a,s);i.checked?r<0&&t.$set(t.invert,"x",a.concat([s])):r>-1&&t.$set(t.invert,"x",a.slice(0,r).concat(a.slice(r+1)))}else t.$set(t.invert,"x",n)}}}),t._v(" Invert x")])]),a("div",[a("label",{staticClass:"uk-form-label",attrs:{for:"form-stacked-text"}},[t._v("y")]),a("div",{staticClass:"uk-form-controls"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.stepSize.y,expression:"stepSize.y"}],staticClass:"uk-input uk-form-small",attrs:{type:"number",name:"inputStepY"},domProps:{value:t.stepSize.y},on:{input:function(e){e.target.composing||t.$set(t.stepSize,"y",e.target.value)}}})]),a("label",{staticClass:"uk-margin-small-right"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.invert.y,expression:"invert.y"}],staticClass:"uk-checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.invert.y)?t._i(t.invert.y,null)>-1:t.invert.y},on:{change:function(e){var a=t.invert.y,i=e.target,n=!!i.checked;if(Array.isArray(a)){var s=null,r=t._i(a,s);i.checked?r<0&&t.$set(t.invert,"y",a.concat([s])):r>-1&&t.$set(t.invert,"y",a.slice(0,r).concat(a.slice(r+1)))}else t.$set(t.invert,"y",n)}}}),t._v(" Invert y")])]),a("div",[a("label",{staticClass:"uk-form-label",attrs:{for:"form-stacked-text"}},[t._v("z")]),a("div",{staticClass:"uk-form-controls"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.stepSize.z,expression:"stepSize.z"}],staticClass:"uk-input uk-form-small",attrs:{type:"number",name:"inputStepZz"},domProps:{value:t.stepSize.z},on:{input:function(e){e.target.composing||t.$set(t.stepSize,"z",e.target.value)}}})]),a("label",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.invert.z,expression:"invert.z"}],staticClass:"uk-checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.invert.z)?t._i(t.invert.z,null)>-1:t.invert.z},on:{change:function(e){var a=t.invert.z,i=e.target,n=!!i.checked;if(Array.isArray(a)){var s=null,r=t._i(a,s);i.checked?r<0&&t.$set(t.invert,"z",a.concat([s])):r>-1&&t.$set(t.invert,"z",a.slice(0,r).concat(a.slice(r+1)))}else t.$set(t.invert,"z",n)}}}),t._v(" Invert z")])])]),a("button",{staticClass:"uk-button uk-button-default uk-margin uk-width-1-1",on:{click:function(e){return t.zeroRequest()}}},[t._v(" Zero coordinates ")])])]),a("li",{staticClass:"uk-open"},[a("a",{staticClass:"uk-accordion-title",attrs:{href:"#"}},[t._v("Move-to")]),a("div",{staticClass:"uk-accordion-content"},[a("form",{on:{submit:function(e){return e.preventDefault(),t.handleSubmit(e)}}},[a("div",{staticClass:"uk-grid-small uk-child-width-1-3",attrs:{"uk-grid":""}},[a("div",[a("label",{staticClass:"uk-form-label",attrs:{for:"form-stacked-text"}},[t._v("x")]),a("div",{staticClass:"uk-form-controls"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.setPosition.x,expression:"setPosition.x"}],staticClass:"uk-input uk-form-small",attrs:{type:"number",name:"inputPositionX"},domProps:{value:t.setPosition.x},on:{input:function(e){e.target.composing||t.$set(t.setPosition,"x",e.target.value)}}})])]),a("div",[a("label",{staticClass:"uk-form-label",attrs:{for:"form-stacked-text"}},[t._v("y")]),a("div",{staticClass:"uk-form-controls"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.setPosition.y,expression:"setPosition.y"}],staticClass:"uk-input uk-form-small",attrs:{type:"number",name:"inputPositionY"},domProps:{value:t.setPosition.y},on:{input:function(e){e.target.composing||t.$set(t.setPosition,"y",e.target.value)}}})])]),a("div",[a("label",{staticClass:"uk-form-label",attrs:{for:"form-stacked-text"}},[t._v("z")]),a("div",{staticClass:"uk-form-controls"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.setPosition.z,expression:"setPosition.z"}],staticClass:"uk-input uk-form-small",attrs:{type:"number",name:"inputPositionZx"},domProps:{value:t.setPosition.z},on:{input:function(e){e.target.composing||t.$set(t.setPosition,"z",e.target.value)}}})])])]),t._m(0)])])]),a("li",{directives:[{name:"show",rawName:"v-show",value:t.fastAutofocusUri||t.normalAutofocusUri,expression:"fastAutofocusUri || normalAutofocusUri"}],staticClass:"uk-open"},[a("a",{staticClass:"uk-accordion-title",attrs:{href:"#"}},[t._v("Autofocus")]),a("div",{staticClass:"uk-accordion-content"},[a("div",{staticClass:"uk-grid-small uk-child-width-expand",attrs:{"uk-grid":""}},[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.isAutofocusing||1==t.isAutofocusing,expression:"!isAutofocusing || isAutofocusing == 1"}]},[t.fastAutofocusUri?a("taskSubmitter",{attrs:{"submit-url":t.fastAutofocusUri,"submit-data":{dz:2e3},"submit-label":"Fast","button-primary":!1,"submit-on-event":"globalFastAutofocusEvent"},on:{taskStarted:function(e){t.isAutofocusing=1},finished:function(e){t.isAutofocusing=0},error:t.modalError}}):t._e()],1),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.isAutofocusing||2==t.isAutofocusing,expression:"!isAutofocusing || isAutofocusing == 2"}]},[t.normalAutofocusUri?a("taskSubmitter",{attrs:{"submit-url":t.normalAutofocusUri,"submit-data":{dz:[-90,-60,-30,0,30,60,90]},"submit-label":"Medium","button-primary":!1},on:{taskStarted:function(e){t.isAutofocusing=2},finished:function(e){t.isAutofocusing=0},error:t.modalError}}):t._e()],1),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.isAutofocusing||3==t.isAutofocusing,expression:"!isAutofocusing || isAutofocusing == 3"}]},[t.normalAutofocusUri?a("taskSubmitter",{attrs:{"submit-url":t.normalAutofocusUri,"submit-data":{dz:[-30,-20,-10,0,10,20,30]},"submit-label":"Fine","button-primary":!1},on:{taskStarted:function(e){t.isAutofocusing=3},finished:function(e){t.isAutofocusing=0},error:t.modalError}}):t._e()],1)])])])])]):a("div",{staticClass:"uk-text-warning"},[a("p",[t._v("Stage positioning is disabled since no stage is connected.")]),a("p",[t._v(" Please check all data and power connections to your motor controller board. ")])])])},E=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",[a("button",{staticClass:"uk-button uk-button-default uk-float-right uk-width-1-1",attrs:{type:"submit"}},[t._v(" Move ")])])}],O=(a("7514"),a("8357")),P={name:"PaneNavigate",components:{taskSubmitter:O["a"]},data:function(){return{stepXy:200,stepZz:50,stepSize:{x:200,y:200,z:50},invert:{x:!1,y:!1,z:!1},setPosition:null,isAutofocusing:0,moveLock:!1,fastAutofocusUri:null,normalAutofocusUri:null,moveInImageCoordinatesUri:null}},computed:{moveActionUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/actions/stage/move")},zeroActionUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/actions/stage/zero")},positionStatusUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/instrument/state/stage/position")},pluginsUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/extensions")}},watch:{stepSize:{deep:!0,handler:function(){this.setLocalStorageObj("navigation_stepSize",this.stepSize)}},invert:{deep:!0,handler:function(){this.setLocalStorageObj("navigation_invert",this.invert)}}},mounted:function(){var t=this;this.stepSize=this.getLocalStorageObj("navigation_stepSize")||this.stepSize,this.invert=this.getLocalStorageObj("navigation_invert")||this.invert,this.$root.$on("globalMoveEvent",(function(e,a,i,n){t.moveRequest(e,a,i,n)})),this.$root.$on("globalMoveInImageCoordinatesEvent",(function(e,a,i){t.moveInImageCoordinatesRequest(e,a,i)})),this.$root.$on("globalMoveStepEvent",(function(e,a,i){t.moveRequest(e*t.stepSize.x*(t.invert.x?-1:1),a*t.stepSize.y*(t.invert.y?-1:1),i*t.stepSize.z*(t.invert.z?-1:1),!1)})),this.updatePosition(),this.updateAutofocusUri(),this.updateMoveInImageCoordinatesUri()},beforeDestroy:function(){this.$root.$off("globalMoveEvent"),this.$root.$off("globalMoveInImageCoordinatesEvent"),this.$root.$off("globalMoveStepEvent")},methods:{handleSubmit:function(){this.moveRequest(this.setPosition.x,this.setPosition.y,this.setPosition.z,!0)},moveRequest:function(t,e,a,i){var n=this;this.moveLock||(this.moveLock=!0,c.a.post(this.moveActionUri,{x:t,y:e,z:a,absolute:i}).then((function(){n.updatePosition()})).catch((function(t){n.modalError(t)})).then((function(){n.moveLock=!1})))},moveInImageCoordinatesRequest:function(t,e){var a=this;this.moveLock||(this.moveLock=!0,this.moveInImageCoordinatesUri||this.modalError("Moving in image coordinates is not supported - you will need to upgrade your microscope's software."),c.a.post(this.moveInImageCoordinatesUri,{x:e,y:t}).then((function(){a.updatePosition()})).catch((function(t){a.modalError(t)})).then((function(){a.moveLock=!1})))},zeroRequest:function(){var t=this;c.a.post(this.zeroActionUri).then((function(){t.updatePosition()})).catch((function(e){t.modalError(e)}))},updatePosition:function(){var t=this;c.a.get(this.positionStatusUri).then((function(e){t.setPosition=e.data})).catch((function(e){t.modalError(e)}))},updateAutofocusUri:function(){var t=this;c.a.get(this.pluginsUri).then((function(e){var a=e.data,i=a.find((function(t){return"org.openflexure.autofocus"===t.title}));i&&(t.fastAutofocusUri=i.links.fast_autofocus.href,t.normalAutofocusUri=i.links.autofocus.href)})).catch((function(e){t.modalError(e)}))},updateMoveInImageCoordinatesUri:function(){var t=this;c.a.get(this.pluginsUri).then((function(e){var a=e.data,i=a.find((function(t){return"org.openflexure.camera_stage_mapping"===t.title}));i&&(t.moveInImageCoordinatesUri=i.links.move_in_image_coordinates.href)})).catch((function(e){t.modalError(e)}))}}},A=P,j=Object(h["a"])(A,T,E,!1,null,null,null),I=j.exports,U=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:t.visibilityChanged,expression:"visibilityChanged"}],ref:"streamDisplay",staticClass:"stream-display uk-width-1-1 uk-height-1-1 scrollTarget",attrs:{id:"stream-display"}},[t.isVisible?a("img",{ref:"click-frame",staticClass:"uk-align-center uk-margin-remove-bottom",attrs:{hidden:!t.streamEnabled,src:t.streamImgUri,alt:"Stream"},on:{dblclick:t.clickMonitor}}):t._e(),t.streamEnabled?t._e():a("div",{staticClass:"uk-height-1-1"},[t.$store.state.waiting?a("div",{staticClass:"uk-position-center"},[a("div",{attrs:{"uk-spinner":"ratio: 4.5"}})]):t.$store.state.disableStream?a("div",{staticClass:"uk-position-center position-relative text-center"},[t._v(" Stream preview disabled ")]):a("div",{staticClass:"uk-position-center position-relative text-center"},[t._v(" No active connection ")])])])},D=[],L={name:"StreamDisplay",data:function(){return{isVisible:!1,displaySize:[0,0],displayPosition:[0,0],resizeTimeoutId:setTimeout(this.doneResizing,500)}},computed:{streamEnabled:function(){return this.$store.getters.ready&&!this.$store.state.disableStream},thisStreamOpen:function(){return!(0==this.displaySize[0])&&!(0==this.displaySize[1])},streamImgUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/streams/mjpeg")},startPreviewUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/actions/camera/preview/start")},stopPreviewUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/actions/camera/preview/stop")},settingsUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/instrument/settings")},autoGpuPreview:function(){return this.$store.state.autoGpuPreview}},watch:{autoGpuPreview:function(t){this.safePreviewRequest(t)}},mounted:function(){var t=this;this.$root.$on("globalTogglePreview",(function(e){t.previewRequest(e)})),this.$root.$on("globalFlashStream",(function(){t.flashStream()})),this.sizeObserver=new ResizeObserver((function(){t.handleResize()}));var e=this.$refs.streamDisplay.parentNode;this.sizeObserver.observe(e)},created:function(){this.safePreviewRequest(this.autoGpuPreview)},beforeDestroy:function(){this.$root.$off("globalTogglePreview"),this.$root.$off("globalFlashStream"),this.sizeObserver.disconnect(),this.$store.commit("removeStream",this._uid)},methods:{visibilityChanged:function(t){this.isVisible=t},flashStream:function(){var t=this.$refs.streamDisplay;t.classList.remove("uk-animation-fade"),t.offsetHeight,t.classList.add("uk-animation-fade"),setTimeout((function(){t.classList.remove("uk-animation-fade")}),800)},clickMonitor:function(t){var e=t.offsetX,a=t.offsetY,i=Math.max(t.target.naturalWidth/t.target.offsetWidth,t.target.naturalHeight/t.target.offsetHeight),n=(.5*t.target.offsetWidth-e)*i,s=(.5*t.target.offsetHeight-a)*i;this.$root.$emit("globalMoveInImageCoordinatesEvent",-n,-s)},handleResize:function(){clearTimeout(this.resizeTimeoutId),this.resizeTimeoutId=setTimeout(this.handleDoneResize,250)},handleDoneResize:function(){var t=this;if(this.recalculateSize(),0==this.displaySize[0]&&0==this.displaySize[1]){if(1==this.$store.state.activeStreams[this._uid]){this.$store.commit("removeStream",this._uid);var e=Object.values(this.$store.state.activeStreams),a=e.every((function(t){return!1===t}));a&&this.safePreviewRequest(!1)}}else this.$store.commit("addStream",this._uid),1==this.$store.state.autoGpuPreview&&(this.safePreviewRequest(!0),setTimeout((function(){return t.safePreviewRequest(!0)}),250))},recalculateSize:function(){var t=this.$refs.streamDisplay.parentNode,e=t.getBoundingClientRect(),a=[e.width,e.height],i=[e.left,e.top],n=[window.screenX,window.screenY],s=window.outerHeight-window.innerHeight,r=[Math.max(0,n[0]+i[0]),Math.max(0,n[1]+i[1]+s)];this.displaySize=a,this.displayPosition=r},safePreviewRequest:function(t){var e=Object.values(this.$store.state.activeStreams),a=e.every((function(t){return!1===t}));return(!0!==t||!a)&&(!(!1===t&&!a)&&this.previewRequest(t))},previewRequest:function(t){var e=this;if(1==this.$store.getters.ready&&1==this.$store.state.autoGpuPreview){var a=null;a=1==t?this.startPreviewUri:this.stopPreviewUri;var i={};1==this.$store.state.trackWindow&&1==t&&(this.recalculateSize(),i={window:[this.displayPosition[0],this.displayPosition[1],this.displaySize[0],this.displaySize[1]]}),c.a.post(a,i).then((function(){})).catch((function(t){e.modalError(t)}))}}}},R=L,z=(a("b9e4"),Object(h["a"])(R,U,D,!1,null,"39d23baa",null)),M=z.exports,N={name:"NavigateContent",components:{paneNavigate:I,streamDisplay:M}},q=N,F=Object(h["a"])(q,x,$,!1,null,null,null),V=F.exports,W=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"uk-height-1-1 uk-margin-remove uk-padding-remove",attrs:{"uk-grid":""}},[a("div",{staticClass:"control-component"},[a("paneCapture")],1),a("div",{staticClass:"view-component uk-width-expand"},[a("streamDisplay")],1)])},B=[],G=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"uk-padding-small",attrs:{id:"paneCapture"}},[a("div",[a("label",{staticClass:"uk-form-label",attrs:{for:"form-stacked-text"}},[t._v("Filename")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.filename,expression:"filename"}],staticClass:"uk-input uk-width-1-1 uk-form-small",attrs:{name:"inputFilename",placeholder:"Leave blank for default"},domProps:{value:t.filename},on:{input:function(e){e.target.composing||(t.filename=e.target.value)}}})]),a("p",{attrs:{"uk-tooltip":"title: Capture will be removed automatically; delay: 500"}},[a("label",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.temporary,expression:"temporary"}],staticClass:"uk-checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.temporary)?t._i(t.temporary,null)>-1:t.temporary},on:{change:function(e){var a=t.temporary,i=e.target,n=!!i.checked;if(Array.isArray(a)){var s=null,r=t._i(a,s);i.checked?r<0&&(t.temporary=a.concat([s])):r>-1&&(t.temporary=a.slice(0,r).concat(a.slice(r+1)))}else t.temporary=n}}}),t._v(" Temporary")])]),a("hr"),a("div",{staticClass:"uk-child-width-1-2",attrs:{"uk-grid":""}},[a("p",[a("label",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.fullResolution,expression:"fullResolution"}],staticClass:"uk-checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.fullResolution)?t._i(t.fullResolution,null)>-1:t.fullResolution},on:{change:function(e){var a=t.fullResolution,i=e.target,n=!!i.checked;if(Array.isArray(a)){var s=null,r=t._i(a,s);i.checked?r<0&&(t.fullResolution=a.concat([s])):r>-1&&(t.fullResolution=a.slice(0,r).concat(a.slice(r+1)))}else t.fullResolution=n}}}),t._v(" Full resolution")])]),a("p",[a("label",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.storeBayer,expression:"storeBayer"}],staticClass:"uk-checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.storeBayer)?t._i(t.storeBayer,null)>-1:t.storeBayer},on:{change:function(e){var a=t.storeBayer,i=e.target,n=!!i.checked;if(Array.isArray(a)){var s=null,r=t._i(a,s);i.checked?r<0&&(t.storeBayer=a.concat([s])):r>-1&&(t.storeBayer=a.slice(0,r).concat(a.slice(r+1)))}else t.storeBayer=n}}}),t._v(" Store raw data")])])]),a("hr"),a("p",[a("label",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.resizeCapture,expression:"resizeCapture"}],staticClass:"uk-checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.resizeCapture)?t._i(t.resizeCapture,null)>-1:t.resizeCapture},on:{change:function(e){var a=t.resizeCapture,i=e.target,n=!!i.checked;if(Array.isArray(a)){var s=null,r=t._i(a,s);i.checked?r<0&&(t.resizeCapture=a.concat([s])):r>-1&&(t.resizeCapture=a.slice(0,r).concat(a.slice(r+1)))}else t.resizeCapture=n}}}),t._v(" Resize capture")])]),a("div",{staticClass:"uk-child-width-1-2",attrs:{"uk-grid":""}},[a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.resizeDims[0],expression:"resizeDims[0]"}],staticClass:"uk-input uk-form-width-medium uk-form-small",class:t.resizeClass,attrs:{type:"number",name:"inputResizeW"},domProps:{value:t.resizeDims[0]},on:{input:function(e){e.target.composing||t.$set(t.resizeDims,0,e.target.value)}}})]),a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.resizeDims[1],expression:"resizeDims[1]"}],staticClass:"uk-input uk-form-width-medium uk-form-small",class:t.resizeClass,attrs:{type:"number",name:"inputResizeH"},domProps:{value:t.resizeDims[1]},on:{input:function(e){e.target.composing||t.$set(t.resizeDims,1,e.target.value)}}})])]),a("ul",{attrs:{"uk-accordion":"multiple: true"}},[a("li",[a("a",{staticClass:"uk-accordion-title",attrs:{href:"#"}},[t._v("Notes")]),a("div",{staticClass:"uk-accordion-content"},[a("div",{staticClass:"uk-margin-small"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.captureNotes,expression:"captureNotes"}],staticClass:"uk-textarea",attrs:{rows:"5",placeholder:"Capture notes"},domProps:{value:t.captureNotes},on:{input:function(e){e.target.composing||(t.captureNotes=e.target.value)}}})])])]),a("li",[a("a",{staticClass:"uk-accordion-title",attrs:{href:"#"}},[t._v("Annotations")]),a("div",{staticClass:"uk-accordion-content"},[a("keyvalList",{model:{value:t.annotations,callback:function(e){t.annotations=e},expression:"annotations"}})],1)]),a("li",[a("a",{staticClass:"uk-accordion-title",attrs:{href:"#"}},[t._v("Tags")]),a("div",{staticClass:"uk-accordion-content"},[a("tagList",{model:{value:t.tags,callback:function(e){t.tags=e},expression:"tags"}})],1)])]),a("hr"),a("ul",{attrs:{"uk-accordion":"multiple: true"}},[t.scanUri?a("li",{class:{"uk-open":t.scanCapture}},[a("a",{staticClass:"uk-accordion-title",attrs:{href:"#"}},[t._v("Stack and Scan")]),a("div",{staticClass:"uk-accordion-content"},[a("div",{staticClass:"uk-margin"},[a("label",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.scanCapture,expression:"scanCapture"}],staticClass:"uk-checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.scanCapture)?t._i(t.scanCapture,null)>-1:t.scanCapture},on:{change:function(e){var a=t.scanCapture,i=e.target,n=!!i.checked;if(Array.isArray(a)){var s=null,r=t._i(a,s);i.checked?r<0&&(t.scanCapture=a.concat([s])):r>-1&&(t.scanCapture=a.slice(0,r).concat(a.slice(r+1)))}else t.scanCapture=n}}}),t._v(" Scan capture")])]),a("div",{class:{"uk-disabled":!t.scanCapture}},[a("div",{staticClass:"uk-grid-small uk-child-width-1-3",attrs:{"uk-grid":""}},[a("div",[a("label",{staticClass:"uk-form-label",attrs:{for:"form-stacked-text"}},[t._v("x step-size")]),a("div",{staticClass:"uk-form-controls"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.scanStepSize.x,expression:"scanStepSize.x"}],staticClass:"uk-input uk-form-small",attrs:{type:"number",name:"inputPositionX"},domProps:{value:t.scanStepSize.x},on:{input:function(e){e.target.composing||t.$set(t.scanStepSize,"x",e.target.value)}}})])]),a("div",[a("label",{staticClass:"uk-form-label",attrs:{for:"form-stacked-text"}},[t._v("y step-size")]),a("div",{staticClass:"uk-form-controls"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.scanStepSize.y,expression:"scanStepSize.y"}],staticClass:"uk-input uk-form-small",attrs:{type:"number",name:"inputPositionY"},domProps:{value:t.scanStepSize.y},on:{input:function(e){e.target.composing||t.$set(t.scanStepSize,"y",e.target.value)}}})])]),a("div",[a("label",{staticClass:"uk-form-label",attrs:{for:"form-stacked-text"}},[t._v("z step-size")]),a("div",{staticClass:"uk-form-controls"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.scanStepSize.z,expression:"scanStepSize.z"}],staticClass:"uk-input uk-form-small",attrs:{type:"number",name:"inputPositionZ"},domProps:{value:t.scanStepSize.z},on:{input:function(e){e.target.composing||t.$set(t.scanStepSize,"z",e.target.value)}}})])])]),a("div",{staticClass:"uk-grid-small uk-child-width-1-3",attrs:{"uk-grid":""}},[a("div",[a("label",{staticClass:"uk-form-label",attrs:{for:"form-stacked-text"}},[t._v("x steps")]),a("div",{staticClass:"uk-form-controls"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.scanSteps.x,expression:"scanSteps.x"}],staticClass:"uk-input uk-form-small",attrs:{type:"number",name:"inputPositionX",min:"1"},domProps:{value:t.scanSteps.x},on:{input:function(e){e.target.composing||t.$set(t.scanSteps,"x",e.target.value)}}})])]),a("div",[a("label",{staticClass:"uk-form-label",attrs:{for:"form-stacked-text"}},[t._v("y steps")]),a("div",{staticClass:"uk-form-controls"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.scanSteps.y,expression:"scanSteps.y"}],staticClass:"uk-input uk-form-small",attrs:{type:"number",name:"inputPositionY",min:"1"},domProps:{value:t.scanSteps.y},on:{input:function(e){e.target.composing||t.$set(t.scanSteps,"y",e.target.value)}}})])]),a("div",[a("label",{staticClass:"uk-form-label",attrs:{for:"form-stacked-text"}},[t._v("z steps")]),a("div",{staticClass:"uk-form-controls"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.scanSteps.z,expression:"scanSteps.z"}],staticClass:"uk-input uk-form-small",attrs:{type:"number",name:"inputPositionZ",min:"1"},domProps:{value:t.scanSteps.z},on:{input:function(e){e.target.composing||t.$set(t.scanSteps,"z",e.target.value)}}})])])]),a("div",{staticClass:"uk-margin-small uk-margin-remove-bottom"},[a("label",{staticClass:"uk-form-label",attrs:{for:"form-stacked-text"}},[t._v("Autofocus")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.scanDeltaZ,expression:"scanDeltaZ"}],staticClass:"uk-select",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.scanDeltaZ=e.target.multiple?a:a[0]}}},[a("option",[t._v("Off")]),a("option",[t._v("Coarse")]),a("option",[t._v("Medium")]),a("option",[t._v("Fine")]),a("option",[t._v("Fast")])])]),a("div",{staticClass:"uk-margin-small uk-margin-remove-bottom"},[a("label",{staticClass:"uk-form-label",attrs:{for:"form-stacked-text"}},[t._v("Scan Style")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.scanStyle,expression:"scanStyle"}],staticClass:"uk-select",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.scanStyle=e.target.multiple?a:a[0]}}},[a("option",[t._v("Raster")]),a("option",[t._v("Snake")]),a("option",[t._v("Spiral")])])]),a("div",{staticClass:"uk-margin-small uk-margin-remove-bottom"},[a("label",{staticClass:"uk-form-label",attrs:{for:"form-stacked-text"}},[t._v("Naming style")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.namingStyle,expression:"namingStyle"}],staticClass:"uk-select",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.namingStyle=e.target.multiple?a:a[0]}}},[a("option",[t._v("Coordinates")]),a("option",[t._v("Number")])])])])])]):t._e(),t.smartScanUri?a("li",{class:{"uk-open":t.smartStack&&t.scanCapture}},[a("a",{staticClass:"uk-accordion-title",attrs:{href:"#"}},[t._v("Smart Stack")]),a("div",{staticClass:"uk-accordion-content",class:{"uk-disabled":!t.scanCapture}},[a("div",{staticClass:"uk-margin"},[a("label",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.smartStack,expression:"smartStack"}],staticClass:"uk-checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.smartStack)?t._i(t.smartStack,null)>-1:t.smartStack},on:{change:function(e){var a=t.smartStack,i=e.target,n=!!i.checked;if(Array.isArray(a)){var s=null,r=t._i(a,s);i.checked?r<0&&(t.smartStack=a.concat([s])):r>-1&&(t.smartStack=a.slice(0,r).concat(a.slice(r+1)))}else t.smartStack=n}}}),t._v(" Enable smart stacking")])]),a("p",[t._v(' Smart stacking is an experimental closed-loop Z stack, that checks the Z stack is centred on the focus. It requires Z stacking to be enabled above (we recommend 9 images in Z) and you must select "fast" autofocus. ')]),a("div",{class:{"uk-disabled":!t.smartStack}},[a("div",{staticClass:"uk-margin-small uk-margin-remove-bottom"},[a("label",{staticClass:"uk-form-label",attrs:{for:"form-stacked-text"}},[t._v("Autofocus range (steps)")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.smartStackAutofocusDz,expression:"smartStackAutofocusDz"}],staticClass:"uk-input uk-form-small",attrs:{type:"number",min:"1000"},domProps:{value:t.smartStackAutofocusDz},on:{input:function(e){e.target.composing||(t.smartStackAutofocusDz=e.target.value)}}})]),a("div",{staticClass:"uk-margin-small uk-margin-remove-bottom"},[a("label",{staticClass:"uk-form-label",attrs:{for:"form-stacked-text"}},[t._v("Alignment range (steps)")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.smartStackAlignDist,expression:"smartStackAlignDist"}],staticClass:"uk-input uk-form-small",attrs:{type:"number",min:"100"},domProps:{value:t.smartStackAlignDist},on:{input:function(e){e.target.composing||(t.smartStackAlignDist=e.target.value)}}})])])])]):t._e()]),t.scanCapture?a("div",{staticClass:"uk-margin uk-margin-remove-top"},[t.smartStack?a("taskSubmitter",{attrs:{"submit-url":t.smartScanUri,"submit-data":t.smartScanPayload,"submit-label":"Start Smart Scan","button-primary":!0},on:{response:t.onScanResponse,error:t.modalError}}):t._e(),t.smartStack?t._e():a("taskSubmitter",{attrs:{"submit-url":t.scanUri,"submit-data":t.scanPayload,"submit-label":"Start Scan","button-primary":!0},on:{response:t.onScanResponse,error:t.modalError}})],1):a("button",{staticClass:"uk-button uk-button-primary uk-margin uk-margin-remove-top uk-width-1-1",on:{click:function(e){return t.handleCapture()}}},[t._v(" Capture ")])])},H=[],Z=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("form",{on:{submit:function(e){return e.preventDefault(),t.handleTagSubmit(e)}}},[a("div",{staticClass:"uk-margin-small uk-flex uk-flex-middle"},[a("div",{staticClass:"uk-margin-remove-top uk-width-expand"},[a("div",{staticClass:"uk-inline uk-width-1-1"},[t._m(0),a("input",{directives:[{name:"model",rawName:"v-model",value:t.newTag,expression:"newTag"}],staticClass:"uk-input uk-form-small",attrs:{type:"text",name:"flavor",placeholder:"Tag"},domProps:{value:t.newTag},on:{input:function(e){e.target.composing||(t.newTag=e.target.value)}}})])]),a("a",{staticClass:"uk-icon uk-margin-left",attrs:{href:"#"},on:{click:function(e){return t.handleTagSubmit()}}},[a("i",{staticClass:"material-icons"},[t._v("add_circle")])])])]),t._l(t.value,(function(e){return a("span",{key:e,staticClass:"uk-label uk-margin-small-right deletable-label",on:{click:function(a){return t.delTag(e)}}},[t._v(" "+t._s(e)+" ")])}))],2)},J=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"uk-form-icon"},[a("i",{staticClass:"material-icons"},[t._v("label")])])}],K=(a("6762"),a("2fdb"),a("75fc")),Y={name:"TagList",props:{value:{type:Array,required:!0}},data:function(){return{newTag:""}},methods:{handleTagSubmit:function(){var t=null!=this.value?Object(K["a"])(this.value):[];t.push(this.newTag),this.newTag="",this.$emit("input",t)},delTag:function(t){var e=null!=this.value?Object(K["a"])(this.value):[];e.includes(t)&&(e=e.filter((function(e){return e!=t}))),this.$emit("input",e)}}},X=Y,Q=Object(h["a"])(X,Z,J,!1,null,"7b170a9a",null),tt=Q.exports,et=a("500b");function at(t,e,a){var i=Object.keys(a),n=localStorage.getItem(t);if(n){var s=JSON.parse(n),r=!0,o=!1,l=void 0;try{for(var u,c=i[Symbol.iterator]();!(r=(u=c.next()).done);r=!0){var d=u.value;d in s&&(e[d]=s[d])}}catch(h){o=!0,l=h}finally{try{r||null==c.return||c.return()}finally{if(o)throw l}}}for(var m=function(){var a={},n=!0,s=!1,r=void 0;try{for(var o,l=i[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var u=o.value;a[u]=e[u]}}catch(h){s=!0,r=h}finally{try{n||null==l.return||l.return()}finally{if(s)throw r}}localStorage.setItem(t,JSON.stringify(a))},p=0,v=i;p<v.length;p++){var f=v[p];e.$watch(f,m,{deep:!0})}}function it(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function nt(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?it(Object(a),!0).forEach((function(e){Object(l["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):it(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function st(){return{filename:"",temporary:!1,fullResolution:!1,storeBayer:!1,resizeCapture:!1,captureNotes:"",scanDeltaZ:"Fast",scanStyle:"Raster",namingStyle:"Coordinates",scanStepSize:{x:800,y:640,z:50},scanSteps:{x:3,y:3,z:5},resizeDims:[640,480],tags:[],annotations:{Client:"openflexure-microscope-jsclient:builtin"},smartStack:!1,smartStackThreshold:.9,smartStackPeakWidth:200,smartStackAlignDist:900,smartStackBacklash:100,smartStackFitStyle:"chevy",smartStackMAndMIndex:10,smartStackAutofocusDz:3e3}}var rt={name:"PaneCapture",components:{tagList:tt,keyvalList:et["a"],taskSubmitter:O["a"]},data:function(){return nt({},st(),{scanCapture:!1,scanUri:null,smartScanUri:null})},computed:{resizeClass:function(){return{"uk-disabled":!this.resizeCapture}},captureActionUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/actions/camera/capture")},pluginsUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/extensions")},basePayload:function(){var t={};return this.filename&&(t.filename=this.filename),t.temporary=this.temporary,t.use_video_port=!this.fullResolution,t.bayer=this.storeBayer,this.resizeCapture&&(t.resize={width:this.resizeDims[0],height:this.resizeDims[1]}),t.annotations=this.annotations,t.tags=this.tags,this.captureNotes&&(t.annotations["Notes"]=this.captureNotes),t},scanPayload:function(){var t={Off:0,Coarse:100,Medium:30,Fine:10,Fast:2e3};return nt({},this.basePayload,{grid:[this.scanSteps.x,this.scanSteps.y,this.scanSteps.z],stride_size:[this.scanStepSize.x,this.scanStepSize.y,this.scanStepSize.z],style:this.scanStyle.toLowerCase(),namemode:this.namingStyle.toLowerCase(),autofocus_dz:t[this.scanDeltaZ],fast_autofocus:"Fast"==this.scanDeltaZ})},smartScanPayload:function(){return nt({},this.scanPayload,{threshold:this.smartStackThreshold,width:this.smartStackPeakWidth,align_dist:this.smartStackAlignDist,backlash:this.smartStackBacklash,fit_style:this.smartStackFitStyle,m_and_m_index:this.smartStackMAndMIndex,autofocus_dz:this.smartStackAutofocusDz})}},mounted:function(){var t=this;this.updateScanUri(),at("captureSettings",this,st()),this.$root.$on("globalCaptureEvent",(function(){t.handleCapture()}))},methods:{handleCapture:function(){var t=this,e=this.basePayload;c.a.post(this.captureActionUri,e).then((function(){t.$root.$emit("globalFlashStream"),t.$root.$emit("globalUpdateCaptures")})).catch((function(e){t.modalError(e)}))},updateScanUri:function(){var t=this;c.a.get(this.pluginsUri).then((function(e){var a=e.data,i=a.find((function(t){return"org.openflexure.scan"===t.title}));i&&(t.scanUri=i.links.tile.href)})).catch((function(e){t.modalError(e)})),c.a.get(this.pluginsUri).then((function(e){var a=e.data,i=a.find((function(t){return"org.openflexure.smart-stack"===t.title}));i&&(t.smartScanUri=i.links.tile.href)})).catch((function(e){t.modalError(e)}))},onScanResponse:function(){this.modalNotify("Finished scan."),this.$root.$emit("globalUpdateCaptures")}}},ot=rt,lt=(a("78fd"),Object(h["a"])(ot,G,H,!1,null,null,null)),ut=lt.exports,ct={name:"CaptureContent",components:{paneCapture:ut,streamDisplay:M}},dt=ct,mt=Object(h["a"])(dt,W,B,!1,null,null,null),pt=mt.exports,vt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"uk-height-1-1 uk-margin-remove uk-padding-remove",attrs:{"uk-grid":""}},[a("div",{staticClass:"control-component"},[a("paneSlideScan")],1),a("div",{staticClass:"view-component uk-width-expand"},[a("streamDisplay")],1)])},ft=[],ht=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"uk-padding-small"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.scanUri,expression:"!scanUri"}]},[t._v("No scan extension found")]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.scanUri,expression:"scanUri"}]},[a("form",{on:{submit:function(t){t.preventDefault()},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.increment()}}},[a("div",{directives:[{name:"show",rawName:"v-show",value:0==t.stepValue,expression:"stepValue == 0"}],attrs:{id:"step-user"}},[a("h3",[t._v("User information (1/4)")]),a("label",{attrs:{for:"username"}},[t._v("Your name:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],staticClass:"uk-input",attrs:{id:"username",type:"text",name:"username",required:""},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}}),a("br"),a("label",{attrs:{for:"currentTime"}},[t._v("Current time (check this is correct):")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.currentTimeForm,expression:"currentTimeForm"}],staticClass:"uk-input",attrs:{id:"currentTime",type:"datetime-local",name:"currentTime"},domProps:{value:t.currentTimeForm},on:{input:function(e){e.target.composing||(t.currentTimeForm=e.target.value)}}})]),a("div",{directives:[{name:"show",rawName:"v-show",value:1==t.stepValue,expression:"stepValue == 1"}],attrs:{id:"step-patient"}},[a("h3",[t._v("Patient information (2/4)")]),a("label",{attrs:{for:"patientID"}},[t._v("Patient ID:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.patientID,expression:"patientID"}],staticClass:"uk-input",attrs:{id:"patientID",type:"text",name:"patientID",required:""},domProps:{value:t.patientID},on:{input:function(e){e.target.composing||(t.patientID=e.target.value)}}}),a("br")]),a("div",{directives:[{name:"show",rawName:"v-show",value:2==t.stepValue,expression:"stepValue == 2"}],attrs:{id:"step-sample"}},[a("h3",[t._v("Sample information (3/4)")]),a("label",[t._v("Sample type:")]),a("br"),a("input",{directives:[{name:"model",rawName:"v-model",value:t.sampleType,expression:"sampleType"}],staticClass:"uk-radio",attrs:{id:"typeThin",type:"radio",value:"thin"},domProps:{checked:t._q(t.sampleType,"thin")},on:{change:function(e){t.sampleType="thin"}}}),a("label",{attrs:{for:"typeThin"}},[t._v("Thin smear")]),a("br"),a("input",{directives:[{name:"model",rawName:"v-model",value:t.sampleType,expression:"sampleType"}],staticClass:"uk-radio",attrs:{id:"typeThick",type:"radio",value:"thick"},domProps:{checked:t._q(t.sampleType,"thick")},on:{change:function(e){t.sampleType="thick"}}}),a("label",{attrs:{for:"typeThick"}},[t._v("Thick smear")]),a("br")]),a("div",{directives:[{name:"show",rawName:"v-show",value:3==t.stepValue,expression:"stepValue == 3"}],attrs:{id:"step-scan"}},[a("h3",[t._v("Start scan (4/4)")]),a("label",[t._v("Check details:")]),a("p",[a("b",[t._v("Your name:")]),t._v(" "+t._s(t.username)+" ")]),a("p",[a("b",[t._v("Patient ID:")]),t._v(" "+t._s(t.patientID)+" ")]),a("p",[a("b",[t._v("Sample type:")]),t._v(" "+t._s(t.sampleType)+" ")])])]),a("div",{attrs:{id:"form-stepper"}},[a("p",{staticClass:"warning"},[t._v(t._s(t.message))]),t.scanUri?a("taskSubmitter",{directives:[{name:"show",rawName:"v-show",value:3==t.stepValue,expression:"stepValue == 3"}],attrs:{"submit-url":t.scanUri,"submit-data":t.payload,"submit-label":"Start scan"},on:{submit:function(e){t.scanRunning=!0},response:function(e){t.scanRunning=!1},error:t.onScanError}}):t._e(),a("br"),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.scanRunning,expression:"!scanRunning"}],staticClass:"grid-container"},[a("button",{staticClass:"uk-button uk-button-primary",attrs:{disabled:t.stepValue<=0,type:"button"},on:{click:function(e){return t.decrement()}}},[t._v(" Previous ")]),a("button",{staticClass:"uk-button uk-button-primary",attrs:{disabled:t.stepValue>=3,type:"button"},on:{click:function(e){return t.increment()}}},[t._v(" Next ")])]),a("p",[a("button",{directives:[{name:"show",rawName:"v-show",value:3==t.stepValue&&!t.scanRunning,expression:"stepValue == 3 && !scanRunning"}],staticClass:"uk-button uk-button-danger uk-width-1-1",attrs:{disabled:t.scanRunning,type:"button"},on:{click:function(e){return t.restart()}}},[t._v(" Restart ")])])],1)])])},gt=[],bt={components:{taskSubmitter:O["a"]},data:function(){return{scanUri:null,stepValue:0,hostDeviceName:null,message:null,username:"",currentTime:this.getLocalDatetimeString(),patientID:"",sampleType:"thin",scanRunning:!1,bayer:!1,grid:[10,10,9],stride_size:[800,600,10],fast_autofocus:!0,autofocus_dz:2e3,style:"raster",use_video_port:!1}},computed:{pluginsUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/extensions")},currentTimeForm:{get:function(){return this.currentTime.substr(0,19)},set:function(t){var e=new Date,a=-e.getTimezoneOffset(),i=a>=0?"+":"-",n=function(t){var e=Math.floor(Math.abs(t));return(e<10?"0":"")+e};this.currentTime=t+i+n(a/60)+":"+n(a%60)}},payload:{get:function(){return{filename:"".concat(this.patientID,"_").concat(this.sampleType),temporary:!1,bayer:this.bayer,grid:this.grid,stride_size:this.stride_size,fast_autofocus:this.fast_autofocus,autofocus_dz:this.autofocus_dz,use_video_port:this.use_video_port,annotations:{patientID:this.patientID,username:this.username,clientDatetime:this.currentTime},tags:["slidescan"]}}}},mounted:function(){this.updateScanUri()},methods:{updateScanUri:function(){var t=this;c.a.get(this.pluginsUri).then((function(e){var a=e.data,i=a.find((function(t){return"org.openflexure.scan"===t.title}));i&&(t.scanUri=i.links.tile.href)})).catch((function(e){t.modalError(e)}))},onScanError:function(t){this.scanRunning=!1,this.modalError(t)},decrement:function(){this.stepValue>0&&(this.stepValue=this.stepValue-1)},increment:function(){return 0!=this.stepValue||this.username?1!=this.stepValue||this.patientID?this.stepValue<3?(this.stepValue=this.stepValue+1,this.message="",!0):void 0:(this.message="Please enter a patient ID",!1):(this.message="Please enter your name",!1)},restart:function(){this.stepValue=0,this.patientID="",this.currentTime=this.getLocalDatetimeString()},getLocalDatetimeString:function(){var t=new Date,e=-t.getTimezoneOffset(),a=e>=0?"+":"-",i=function(t){var e=Math.floor(Math.abs(t));return(e<10?"0":"")+e};return t.getFullYear()+"-"+i(t.getMonth()+1)+"-"+i(t.getDate())+"T"+i(t.getHours())+":"+i(t.getMinutes())+":"+i(t.getSeconds())+a+i(e/60)+":"+i(e%60)}}},kt=bt,yt=(a("4088"),Object(h["a"])(kt,ht,gt,!1,null,null,null)),_t=yt.exports,wt={name:"SlideScanContent",components:{paneSlideScan:_t,streamDisplay:M}},Ct=wt,St=Object(h["a"])(Ct,vt,ft,!1,null,null,null),xt=St.exports,$t=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"uk-height-1-1 uk-margin-remove uk-padding-remove",attrs:{"uk-grid":""}},[a("div",{staticClass:"view-component uk-width-expand"},[a("streamDisplay")],1)])},Tt=[],Et={name:"ViewContent",components:{streamDisplay:M}},Ot=Et,Pt=Object(h["a"])(Ot,$t,Tt,!1,null,null,null),At=Pt.exports,jt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"uk-height-1-1 uk-margin-remove uk-padding-remove",attrs:{"uk-grid":""}},[a("div",{staticClass:"settings-nav"},[a("ul",{staticClass:"uk-nav uk-nav-default"},[a("li",{staticClass:"uk-nav-header"},[t._v("Application settings")]),a("li",[a("tabIcon",{attrs:{id:"settings-display-icon","tab-i-d":"display","show-title":!1,"show-tooltip":!1,"require-connection":!1,"current-tab":t.currentTab},on:{"set-tab":t.setTab}},[t._v(" Display ")])],1),a("li",[a("tabIcon",{attrs:{id:"settings-features-icon","tab-i-d":"features","show-title":!1,"show-tooltip":!1,"require-connection":!1,"current-tab":t.currentTab},on:{"set-tab":t.setTab}},[t._v(" Features ")])],1),a("li",{staticClass:"uk-nav-header"},[t._v("Microscope settings")]),a("li",[a("tabIcon",{attrs:{id:"settings-camera-icon","tab-i-d":"camera","show-title":!1,"show-tooltip":!1,"require-connection":!0,"current-tab":t.currentTab},on:{"set-tab":t.setTab}},[t._v(" Camera ")])],1),a("li",[a("tabIcon",{attrs:{id:"settings-stage-icon","tab-i-d":"stage","show-title":!1,"show-tooltip":!1,"require-connection":!0,"current-tab":t.currentTab},on:{"set-tab":t.setTab}},[t._v(" Stage ")])],1),a("li",[a("tabIcon",{attrs:{id:"settings-mapping-icon","tab-i-d":"mapping","show-title":!1,"show-tooltip":!1,"require-connection":!0,"current-tab":t.currentTab},on:{"set-tab":t.setTab}},[t._v(" Camera/stage mapping ")])],1),a("li",[a("tabIcon",{attrs:{id:"settings-microscope-icon","tab-i-d":"microscope","show-title":!1,"show-tooltip":!1,"require-connection":!0,"current-tab":t.currentTab},on:{"set-tab":t.setTab}},[t._v(" General ")])],1)])]),a("div",{staticClass:"view-component uk-width-expand uk-padding-small"},[a("tabContent",{attrs:{"tab-i-d":"display","require-connection":!1,"current-tab":t.currentTab}},[a("div",{staticClass:"settings-pane uk-padding-small"},[a("appSettings"),a("streamSettings")],1)]),a("tabContent",{attrs:{"tab-i-d":"features","require-connection":!1,"current-tab":t.currentTab}},[a("div",{staticClass:"settings-pane uk-padding-small"},[a("featuresSettings")],1)]),a("tabContent",{attrs:{"tab-i-d":"camera","require-connection":!0,"current-tab":t.currentTab}},[a("div",{staticClass:"settings-pane uk-padding-small"},[a("cameraSettings")],1)]),a("tabContent",{attrs:{"tab-i-d":"stage","require-connection":!0,"current-tab":t.currentTab}},[a("div",{staticClass:"settings-pane uk-padding-small"},[a("stageSettings")],1)]),a("tabContent",{attrs:{"tab-i-d":"mapping","require-connection":!0,"current-tab":t.currentTab}},[a("div",{staticClass:"settings-pane uk-padding-small"},[a("CSMSettings")],1)]),a("tabContent",{attrs:{"tab-i-d":"microscope","require-connection":!0,"current-tab":t.currentTab}},[a("div",{staticClass:"settings-pane uk-padding-small"},[a("h3",[t._v("Microscope settings")]),a("microscopeSettings")],1)])],1)])},It=[],Ut=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"uk-width-large",attrs:{id:"streamSettings"}},[a("div",[a("h3",[t._v("Stream settings")]),a("label",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.disableStream,expression:"disableStream"}],staticClass:"uk-checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.disableStream)?t._i(t.disableStream,null)>-1:t.disableStream},on:{change:function(e){var a=t.disableStream,i=e.target,n=!!i.checked;if(Array.isArray(a)){var s=null,r=t._i(a,s);i.checked?r<0&&(t.disableStream=a.concat([s])):r>-1&&(t.disableStream=a.slice(0,r).concat(a.slice(r+1)))}else t.disableStream=n}}}),t._v(" Disable web stream")]),a("p",{staticClass:"uk-margin-small"},[t._v(" This will disable the embedded web stream of the camera. ")])]),a("br"),a("div",[a("h3",[t._v("Microscope display output")]),a("div",{attrs:{"uk-grid":""}},[a("div",[a("label",{class:[{"uk-disabled":!this.$store.getters.ready}]},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.autoGpuPreview,expression:"autoGpuPreview"}],staticClass:"uk-checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.autoGpuPreview)?t._i(t.autoGpuPreview,null)>-1:t.autoGpuPreview},on:{change:function(e){var a=t.autoGpuPreview,i=e.target,n=!!i.checked;if(Array.isArray(a)){var s=null,r=t._i(a,s);i.checked?r<0&&(t.autoGpuPreview=a.concat([s])):r>-1&&(t.autoGpuPreview=a.slice(0,r).concat(a.slice(r+1)))}else t.autoGpuPreview=n}}}),t._v(" Enable GPU preview")])]),a("div",[a("label",{class:[{"uk-disabled":!this.$store.getters.ready}]},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.trackWindow,expression:"trackWindow"}],staticClass:"uk-checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.trackWindow)?t._i(t.trackWindow,null)>-1:t.trackWindow},on:{change:function(e){var a=t.trackWindow,i=e.target,n=!!i.checked;if(Array.isArray(a)){var s=null,r=t._i(a,s);i.checked?r<0&&(t.trackWindow=a.concat([s])):r>-1&&(t.trackWindow=a.slice(0,r).concat(a.slice(r+1)))}else t.trackWindow=n}}}),t._v(" Track window")])])]),a("p",[t._v(" Enable GPU preview turns on a low-latency camera preview drawn directly to the Raspberry Pi display output. ")]),t._m(0)])])},Dt=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",{staticClass:"uk-margin-small"},[a("b",[t._v("Content, such as your mouse, won't be visible behind this preview.")]),t._v(" Track Window will attempt to resize the GPU preview based on the current window size, however this is often imperfect and cannot track window movement. ")])}],Lt={name:"StreamSettings",data:function(){return{}},computed:{disableStream:{get:function(){return this.$store.state.disableStream},set:function(t){this.$store.commit("changeDisableStream",t)}},autoGpuPreview:{get:function(){return this.$store.state.autoGpuPreview},set:function(t){this.$store.commit("changeAutoGpuPreview",t)}},trackWindow:{get:function(){return this.$store.state.trackWindow},set:function(t){this.$store.commit("changeTrackWindow",t)}}},watch:{disableStream:function(t){this.setLocalStorageObj("disableStream",t)},autoGpuPreview:function(t){this.setLocalStorageObj("autoGpuPreview",t)},trackWindow:function(t){this.setLocalStorageObj("trackWindow",t)}},created:function(){var t=["localhost","0.0.0.0","127.0.0.1","[::1]"].includes(window.location.hostname),e={disableStream:!0,autoGpuPreview:!0,trackWindow:!0};for(var a in e)null!==localStorage.getItem(a)?this[a]=this.getLocalStorageObj(a):t&&(console.log("".concat(a," set to default value for a local connection")),this[a]=e[a])}},Rt=Lt,zt=Object(h["a"])(Rt,Ut,Dt,!1,null,null,null),Mt=zt.exports,Nt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.settings?a("div",{staticClass:"uk-width-large",attrs:{id:"microscopeSettings"}},[a("form",{on:{submit:function(e){return e.preventDefault(),t.applySettingsRequest(e)}}},[a("div",[a("label",{staticClass:"uk-form-label",attrs:{for:"form-stacked-text"}},[t._v("Microscope name")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.settings.name,expression:"settings.name"}],staticClass:"uk-input uk-width-1-1 uk-form-small",attrs:{name:"inputFilename",placeholder:"Leave blank for default"},domProps:{value:t.settings.name},on:{input:function(e){e.target.composing||t.$set(t.settings,"name",e.target.value)}}})]),a("br"),a("button",{staticClass:"uk-button uk-button-primary uk-margin-small uk-width-1-1",attrs:{type:"submit"}},[t._v(" Apply Settings ")])])]):t._e()},qt=[],Ft=(a("7f7f"),{name:"MicroscopeSettings",data:function(){return{settings:null}},computed:{settingsUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/instrument/settings")}},mounted:function(){this.updateSettings()},methods:{updateSettings:function(){var t=this;c.a.get(this.settingsUri).then((function(e){t.settings=e.data})).catch((function(e){t.modalError(e)}))},applySettingsRequest:function(){var t=this,e={name:this.settings.name};c.a.put(this.settingsUri,e).then((function(){t.updateSettings(),t.modalNotify("Microscope settings applied.")})).catch((function(e){t.modalError(e)}))}}}),Vt=Ft,Wt=(a("f62e"),Object(h["a"])(Vt,Nt,qt,!1,null,null,null)),Bt=Wt.exports,Gt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"cameraSettings"}},[a("div",{staticClass:"uk-grid uk-grid-divider uk-child-width-expand",attrs:{"uk-grid":""}},[a("div",{staticClass:"uk-width-large"},[a("h3",[t._v("Manual camera settings")]),a("form",{on:{submit:function(e){return e.preventDefault(),t.applySettingsRequest(e)}}},[a("div",{staticClass:"uk-margin-small-bottom"},[a("ul",{attrs:{"uk-accordion":"multiple: true"}},[a("li",{staticClass:"uk-open"},[a("a",{staticClass:"uk-accordion-title",attrs:{href:"#"}},[t._v("Pi Camera Settings")]),a("div",{staticClass:"uk-accordion-content"},[void 0!==t.picamera.shutter_speed?a("div",[a("label",{staticClass:"uk-form-label",attrs:{for:"form-stacked-text"}},[t._v("Exposure time")]),a("div",{staticClass:"uk-form-controls"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.picamera.shutter_speed,expression:"picamera.shutter_speed"}],staticClass:"uk-input uk-form-small",attrs:{type:"number"},domProps:{value:t.picamera.shutter_speed},on:{input:function(e){e.target.composing||t.$set(t.picamera,"shutter_speed",e.target.value)}}})])]):t._e(),void 0!==t.picamera.analog_gain?a("div",[a("label",{staticClass:"uk-form-label",attrs:{for:"form-stacked-text"}},[t._v("Analogue gain")]),a("div",{staticClass:"uk-form-controls"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.picamera.analog_gain,expression:"picamera.analog_gain"}],staticClass:"uk-input uk-form-small",attrs:{type:"number",step:"0.0000000000000001"},domProps:{value:t.picamera.analog_gain},on:{input:function(e){e.target.composing||t.$set(t.picamera,"analog_gain",e.target.value)}}})])]):t._e(),void 0!==t.picamera.digital_gain?a("div",[a("label",{staticClass:"uk-form-label",attrs:{for:"form-stacked-text"}},[t._v("Digital gain")]),a("div",{staticClass:"uk-form-controls"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.picamera.digital_gain,expression:"picamera.digital_gain"}],staticClass:"uk-input uk-form-small",attrs:{type:"number",step:"0.0000000000000001"},domProps:{value:t.picamera.digital_gain},on:{input:function(e){e.target.composing||t.$set(t.picamera,"digital_gain",e.target.value)}}})])]):t._e(),void 0!==t.picamera.awb_gains?a("div",[a("label",{staticClass:"uk-form-label",attrs:{for:"form-stacked-text"}},[t._v(" White Balance gains ")]),a("div",{staticClass:"uk-form-controls"},[a("label",{staticClass:"uk-form-label"},[t._v("R:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.picamera.awb_gains[0],expression:"picamera.awb_gains[0]"}],staticClass:"uk-input uk-form-small",attrs:{type:"number",step:"0.0000000000000001"},domProps:{value:t.picamera.awb_gains[0]},on:{input:function(e){e.target.composing||t.$set(t.picamera.awb_gains,0,e.target.value)}}}),a("label",{staticClass:"uk-form-label"},[t._v("B:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.picamera.awb_gains[1],expression:"picamera.awb_gains[1]"}],staticClass:"uk-input uk-form-small",attrs:{type:"number",step:"0.0000000000000001"},domProps:{value:t.picamera.awb_gains[1]},on:{input:function(e){e.target.composing||t.$set(t.picamera.awb_gains,1,e.target.value)}}})])]):t._e()])]),a("li",{staticClass:"uk-open"},[a("a",{staticClass:"uk-accordion-title",attrs:{href:"#"}},[t._v("Image Quality")]),a("div",{staticClass:"uk-accordion-content"},[a("div",{staticClass:"uk-child-width-1-2",attrs:{"uk-grid":""}},[void 0!==t.jpeg_quality?a("div",[a("label",{staticClass:"uk-form-label",attrs:{for:"form-stacked-text"}},[t._v("JPEG capture quality (%)")]),a("div",{staticClass:"uk-form-controls"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.jpeg_quality,expression:"jpeg_quality"}],staticClass:"uk-input uk-form-small",attrs:{type:"number",step:"1"},domProps:{value:t.jpeg_quality},on:{input:function(e){e.target.composing||(t.jpeg_quality=e.target.value)}}})])]):t._e(),void 0!==t.stream_resolution?a("div",[a("label",{staticClass:"uk-form-label",attrs:{for:"form-stacked-text"}},[t._v("Stream resolution")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.stream_resolution,expression:"stream_resolution"}],staticClass:"uk-select uk-form-small",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.stream_resolution=e.target.multiple?a:a[0]}}},t._l(t.resolutionOptions,(function(e){return a("option",{key:e.value[0],domProps:{value:e.value}},[t._v(" "+t._s(e.text)+" ")])})),0)]):t._e()])])]),a("li",[a("a",{staticClass:"uk-accordion-title",attrs:{href:"#"}},[t._v("Advanced")]),a("div",{staticClass:"uk-accordion-content"},[void 0!==t.mjpeg_bitrate?a("div",[a("label",{staticClass:"uk-form-label",attrs:{for:"form-stacked-text"}},[t._v("Camera bitrate")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.mjpeg_bitrate,expression:"mjpeg_bitrate"}],staticClass:"uk-select uk-form-small",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.mjpeg_bitrate=e.target.multiple?a:a[0]}}},t._l(t.bitrateOptions,(function(e){return a("option",{key:e.value,domProps:{value:e.value}},[t._v(" "+t._s(e.text)+" ")])})),0),t._m(0)]):t._e(),void 0!==t.picamera.framerate?a("div",{staticClass:"uk-margin-top"},[a("label",{staticClass:"uk-form-label",attrs:{for:"form-stacked-text"}},[t._v("Camera framerate")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.picamera.framerate,expression:"picamera.framerate"}],staticClass:"uk-select uk-form-small",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.picamera,"framerate",e.target.multiple?a:a[0])}}},t._l(t.framerateOptions,(function(e){return a("option",{key:e.value,domProps:{value:e.value}},[t._v(" "+t._s(e.text)+" ")])})),0),t._m(1)]):t._e()])])])]),a("button",{staticClass:"uk-button uk-button-primary uk-margin-small uk-width-1-1",attrs:{type:"submit"}},[t._v(" Apply Settings ")])]),a("h3",[t._v("Automatic calibration")]),a("cameraCalibrationSettings")],1),a("div",{attrs:{id:"mini-stream"}},[a("miniStreamDisplay")],1)])])},Ht=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",{staticClass:"uk-margin-remove"},[t._v(" This option sets the target bitrate for camera recordings."),a("br"),a("b",[t._v("Limiting bitrate may impact fast-autofocus reliability.")]),t._v(" However is guaranteed to fix the live stream disappearing for some highly detailed samples. ")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",{staticClass:"uk-margin-remove"},[t._v(" This option sets the framerate of the Pi Camera video encoder. The actual stream framerate is determined by network speed, and is limited by the encoder framerate."),a("br"),a("b",[t._v("Lowering framerate may impact fast-autofocus accuracy.")])])}],Zt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",["recalibrate"in t.recalibrationLinks?a("div",{staticClass:"uk-margin-small"},[a("taskSubmitter",{attrs:{"can-terminate":!1,"requires-confirmation":!0,"confirmation-message":"Start recalibration? This may take a while, and the microscope will be locked during this time.","submit-url":t.recalibrationLinks.recalibrate.href,"submit-label":"Full Auto-Calibrate"},on:{response:t.onRecalibrateResponse,error:t.modalError}})],1):t._e(),"auto_exposure_from_raw"in t.recalibrationLinks?a("div",{staticClass:"uk-margin-small"},[a("taskSubmitter",{attrs:{"can-terminate":!1,"requires-confirmation":!1,"submit-url":t.recalibrationLinks.auto_exposure_from_raw.href,"submit-label":"Auto gain & shutter speed"},on:{response:t.onRecalibrateResponse,error:t.modalError}})],1):t._e(),"auto_white_balance_from_raw"in t.recalibrationLinks?a("div",{staticClass:"uk-margin-small"},[a("taskSubmitter",{attrs:{"can-terminate":!1,"requires-confirmation":!1,"submit-url":t.recalibrationLinks.auto_white_balance_from_raw.href,"submit-label":"Auto white balance"},on:{response:t.onRecalibrateResponse,error:t.modalError}})],1):t._e(),"auto_lens_shading_table"in t.recalibrationLinks?a("div",{staticClass:"uk-margin-small"},[a("taskSubmitter",{attrs:{"can-terminate":!1,"requires-confirmation":!0,"confirmation-message":"Is the microscope looking at an evenly illuminated, empty field of view? If not, the current image will show through in any images captured afterwards.","submit-url":t.recalibrationLinks.auto_lens_shading_table.href,"submit-label":"Auto flat field correction"},on:{response:t.onRecalibrateResponse,error:t.modalError}})],1):t._e(),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showExtraSettings,expression:"showExtraSettings"}],staticClass:"uk-child-width-expand"},["flatten_lens_shading_table"in t.recalibrationLinks?a("button",{staticClass:"uk-button uk-button-danger uk-width-1-1",on:{click:t.flattenLensShadingTableRequest}},[t._v(" Disable flat field correction ")]):t._e()]),t.LstDownloadEnabled?a("div",[a("a",{staticClass:"uk-button uk-button-default uk-width-large uk-margin-small-top uk-align-center",attrs:{href:t.LstDownloadUri,download:""}},[t._v("Download Lens-Shading Table")])]):t._e()])},Jt=[],Kt={name:"CameraCalibrationSettings",components:{taskSubmitter:O["a"]},props:{showExtraSettings:{type:Boolean,required:!1,default:!0}},data:function(){return{recalibrationLinks:{},isCalibrating:!1,LstDownloadEnabled:!1}},computed:{pluginsUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/extensions")},LstDownloadUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/instrument/camera/lst")}},mounted:function(){this.updateRecalibrationLinks(),this.checkLstDownload()},methods:{updateRecalibrationLinks:function(){var t=this;c.a.get(this.pluginsUri).then((function(e){var a=e.data,i=a.find((function(t){return"org.openflexure.calibration.picamera"===t.title}));t.recalibrationLinks=i?i.links:{}})).catch((function(e){t.modalError(e)}))},checkLstDownload:function(){var t=this;c.a.get(this.LstDownloadUri).then((function(e){200===e.status?t.LstDownloadEnabled=!0:t.LstDownloadEnabled=!1})).catch((function(e){t.modalError(e)}))},onRecalibrateResponse:function(){this.modalNotify("Finished recalibration.")},flattenLensShadingTableRequest:function(){c.a.post(this.recalibrationLinks.flatten_lens_shading_table.href)},deleteLensShadingTableRequest:function(){c.a.post(this.recalibrationLinks.delete_lens_shading_table.href)}}},Yt=Kt,Xt=Object(h["a"])(Yt,Zt,Jt,!1,null,null,null),Qt=Xt.exports,te=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:t.visibilityChanged,expression:"visibilityChanged"}],ref:"streamDisplay",staticClass:"stream-display uk-width-1-1 uk-height-1-1 scrollTarget",attrs:{id:"stream-display"}},[t.isVisible?a("img",{ref:"click-frame",staticClass:"uk-align-center uk-margin-remove-bottom",attrs:{src:t.streamImgUri,alt:"Stream"}}):t._e()])},ee=[],ae={name:"MiniStreamDisplay",data:function(){return{isVisible:!1}},computed:{streamImgUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/streams/mjpeg")}},methods:{visibilityChanged:function(t){this.isVisible=t}}},ie=ae,ne=(a("6cd3"),Object(h["a"])(ie,te,ee,!1,null,"55de16be",null)),se=ne.exports,re={name:"CameraSettings",components:{cameraCalibrationSettings:Qt,miniStreamDisplay:se},data:function(){return{picamera:{shutter_speed:void 0,analog_gain:void 0,digital_gain:void 0,framerate:void 0,awb_gains:void 0},mjpeg_bitrate:void 0,stream_resolution:void 0,jpeg_quality:void 0,bitrateOptions:[{text:"Maximum (unlimited)",value:-1},{text:"High (25Mbps)",value:25e6},{text:"Normal (17Mbps)",value:17e6},{text:"Low (5Mbps)",value:5e6},{text:"Very low (2.5Mbps)",value:25e5}],resolutionOptions:[{text:"Higher (832, 624)",value:[832,624]},{text:"Normal (640, 480)",value:[640,480]}],framerateOptions:[{text:"Normal (30fps)",value:30},{text:"Low (15fps)",value:15},{text:"Very low (10fps)",value:10}]}},computed:{settingsUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/instrument/settings")}},mounted:function(){this.updateSettings()},methods:{updateSettings:function(){var t=this;c.a.get(this.settingsUri).then((function(e){var a=e.data.camera;t.mjpeg_bitrate=a.mjpeg_bitrate,t.jpeg_quality=a.jpeg_quality,t.stream_resolution=a.stream_resolution,a.picamera&&(t.picamera.analog_gain=a.picamera.analog_gain,t.picamera.digital_gain=a.picamera.digital_gain,t.picamera.shutter_speed=a.picamera.shutter_speed,t.picamera.framerate=a.picamera.framerate,t.picamera.awb_gains=a.picamera.awb_gains)})).catch((function(e){t.modalError(e)}))},applySettingsRequest:function(){var t=this,e={camera:{mjpeg_bitrate:parseInt(this.mjpeg_bitrate),jpeg_quality:parseInt(this.jpeg_quality),stream_resolution:this.stream_resolution,picamera:{shutter_speed:parseFloat(this.picamera.shutter_speed),analog_gain:parseFloat(this.picamera.analog_gain),digital_gain:parseFloat(this.picamera.digital_gain),framerate:parseInt(this.picamera.framerate),awb_gains:[parseFloat(this.picamera.awb_gains[0]),parseFloat(this.picamera.awb_gains[1])]}}};console.log(e),c.a.put(this.settingsUri,e).then((function(){return new Promise((function(t){return setTimeout(t,500)}))})).then((function(){t.updateSettings(),t.modalNotify("Camera settings applied.")})).catch((function(e){t.modalError(e)}))}}},oe=re,le=(a("25c5"),Object(h["a"])(oe,Gt,Ht,!1,null,null,null)),ue=le.exports,ce=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"uk-width-large",attrs:{id:"appSettings"}},[a("h3",[t._v("Appearance")]),a("p",[a("label",[t._v(" Theme "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.appTheme,expression:"appTheme"}],staticClass:"uk-select",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.appTheme=e.target.multiple?a:a[0]}}},[a("option",{attrs:{value:"light"}},[t._v("Light")]),a("option",{attrs:{value:"dark"}},[t._v("Dark")]),a("option",{attrs:{value:"system"}},[t._v("System")])])])])])},de=[],me={name:"AppSettings",data:function(){return{}},computed:{appTheme:{get:function(){return this.$store.state.appTheme},set:function(t){this.$store.commit("changeAppTheme",t)}}},watch:{appTheme:function(){this.setLocalStorageObj("appTheme",this.appTheme)}},mounted:function(){this.appTheme=this.getLocalStorageObj("appTheme")||this.appTheme}},pe=me,ve=Object(h["a"])(pe,ce,de,!1,null,null,null),fe=ve.exports,he=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"uk-width-large",attrs:{id:"appSettings"}},[a("h3",[t._v("Additional features")]),a("p",{staticClass:"uk-margin-small"},[a("label",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.IHIEnabled,expression:"IHIEnabled"}],staticClass:"uk-checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.IHIEnabled)?t._i(t.IHIEnabled,null)>-1:t.IHIEnabled},on:{change:function(e){var a=t.IHIEnabled,i=e.target,n=!!i.checked;if(Array.isArray(a)){var s=null,r=t._i(a,s);i.checked?r<0&&(t.IHIEnabled=a.concat([s])):r>-1&&(t.IHIEnabled=a.slice(0,r).concat(a.slice(r+1)))}else t.IHIEnabled=n}}}),t._v(" Enable IHI Slide Scan")])]),t._m(0),a("p",{staticClass:"uk-margin-small",class:{"uk-text-muted":!t.imjoyPermitted}},[a("label",{attrs:{disabled:!t.imjoyPermitted}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.imjoyEnabled,expression:"imjoyEnabled"}],staticClass:"uk-checkbox",attrs:{type:"checkbox",disabled:!t.imjoyPermitted},domProps:{checked:Array.isArray(t.imjoyEnabled)?t._i(t.imjoyEnabled,null)>-1:t.imjoyEnabled},on:{change:function(e){var a=t.imjoyEnabled,i=e.target,n=!!i.checked;if(Array.isArray(a)){var s=null,r=t._i(a,s);i.checked?r<0&&(t.imjoyEnabled=a.concat([s])):r>-1&&(t.imjoyEnabled=a.slice(0,r).concat(a.slice(r+1)))}else t.imjoyEnabled=n}}}),t._v(" Enable ImJoy plugin engine ")])]),t.imjoyPermitted?a("p",{staticClass:"uk-margin-small"},[a("a",{attrs:{href:"https://imjoy.io/"}},[t._v("ImJoy")]),t._v(" enables integration with a wide variety of microscopy and image analysis applications, including ImageJ.JS and Kaibu. Support for ImJoy within the OFM software is currently experimental, and it may slow down loading of the application. ")]):t._e(),t.imjoyPermitted?t._e():a("p",{staticClass:"uk-margin-small uk-text-muted"},[t._v(" ImJoy plugins are disabled in this build of the OpenFlexure software. ")]),a("p",{staticClass:"uk-margin-small"},[a("label",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.galleryEnabled,expression:"galleryEnabled"}],staticClass:"uk-checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.galleryEnabled)?t._i(t.galleryEnabled,null)>-1:t.galleryEnabled},on:{change:function(e){var a=t.galleryEnabled,i=e.target,n=!!i.checked;if(Array.isArray(a)){var s=null,r=t._i(a,s);i.checked?r<0&&(t.galleryEnabled=a.concat([s])):r>-1&&(t.galleryEnabled=a.slice(0,r).concat(a.slice(r+1)))}else t.galleryEnabled=n}}}),t._v(" Enable Gallery")])]),a("p",{staticClass:"uk-margin-small"},[t._v(' The "gallery" tab can cause performance issues; un-tick the box above to disable it. ')])])},ge=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",{staticClass:"uk-margin-small"},[t._v(" Enabling IHI Slide Scan will add a new tab designed to simplify acquiring blood smear tile scans. "),a("br"),t._v(" While this may be useful for other applications, it is primarily designed for use in clinics acquiring blood smear samples using a 100x oil-immersion objective, with a Raspberry Pi Camera v2. ")])}],be={name:"FeaturesSettings",data:function(){return{}},computed:{IHIEnabled:{get:function(){return this.$store.state.IHIEnabled},set:function(t){this.$store.commit("changeIHIEnabled",t)}},imjoyEnabled:{get:function(){return this.$store.state.imjoyEnabled},set:function(t){this.$store.commit("changeImjoyEnabled",t)}},galleryEnabled:{get:function(){return this.$store.state.galleryEnabled},set:function(t){this.$store.commit("changeGalleryEnabled",t)}},imjoyPermitted:function(){return!0}},watch:{IHIEnabled:function(){this.setLocalStorageObj("IHIEnabled",this.IHIEnabled)},imjoyEnabled:function(){this.setLocalStorageObj("imjoyEnabled",this.imjoyEnabled)},galleryEnabled:function(){this.setLocalStorageObj("galleryEnabled",this.galleryEnabled)}},mounted:function(){this.IHIEnabled=this.getLocalStorageObj("IHIEnabled")||this.IHIEnabled,this.imjoyEnabled=this.getLocalStorageObj("imjoyEnabled")||this.imjoyEnabled,this.galleryEnabled=this.getLocalStorageObj("galleryEnabled")||this.galleryEnabled}},ke=be,ye=Object(h["a"])(ke,he,ge,!1,null,null,null),_e=ye.exports,we=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"uk-grid uk-grid-divider uk-child-width-expand",attrs:{id:"CSMSettings","uk-grid":""}},[a("div",{staticClass:"uk-width-large"},[a("h3",[t._v("Camera/stage mapping")]),a("p",[t._v(" Camera/stage mapping allows the stage to move relative to the camera view. This enables functions like click-to-move, and more precise tile scans. ")]),a("CSMCalibrationSettings")],1),a("div",{attrs:{id:"mini-stream"}},[a("miniStreamDisplay")],1)])},Ce=[],Se=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"CSMCalibrationSettings"}},["calibrate_xy"in t.recalibrationLinks?a("div",{staticClass:"uk-margin-small"},[a("taskSubmitter",{attrs:{"button-primary":!0,"can-terminate":!1,"requires-confirmation":!0,"confirmation-message":"Start recalibration of the stage to the camera? This may take a while, and the microscope will be locked during this time.","submit-url":t.recalibrationLinks.calibrate_xy.href,"submit-label":"Auto-Calibrate using camera"},on:{response:t.onRecalibrateResponse,error:t.modalError}})],1):t._e(),"get_calibration"in t.recalibrationLinks?a("button",{directives:[{name:"show",rawName:"v-show",value:t.dataAvailable&&t.showExtraSettings,expression:"dataAvailable && showExtraSettings"}],staticClass:"uk-button uk-button-default uk-width-1-1",attrs:{type:"button"},on:{click:function(e){return t.getCalibrationData()}}},[t._v(" Download calibration data ")]):t._e()])},xe=[],$e={name:"CSMCalibrationSettings",components:{taskSubmitter:O["a"]},props:{showExtraSettings:{type:Boolean,required:!1,default:!0}},data:function(){return{settings:null,recalibrationLinks:{},isCalibrating:!1,dataAvailable:!1}},computed:{settingsUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/instrument/settings")},pluginsUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/extensions")}},mounted:function(){this.updateSettings(),this.updateRecalibrationLinks()},methods:{updateSettings:function(){var t=this;c.a.get(this.settingsUri).then((function(e){t.settings=e.data.extensions["org.openflexure.camera_stage_mapping"]})).catch((function(e){t.modalError(e),t.settings={}}))},updateCalibrationDataAvailability:function(){var t=this;"get_calibration"in this.recalibrationLinks&&c.a.get(this.recalibrationLinks.get_calibration.href).then((function(e){0===Object.keys(e.data).length?t.dataAvailable=!1:t.dataAvailable=!0})).catch((function(e){t.modalError(e)}))},getCalibrationData:function(){var t=this;c.a.get(this.recalibrationLinks.get_calibration.href).then((function(t){if(t.data!={}){var e=JSON.stringify(t.data),a=window.URL.createObjectURL(new Blob([e])),i=document.createElement("a");i.href=a,i.setAttribute("download","csm_calibration.json"),document.body.appendChild(i),i.click()}})).catch((function(e){t.modalError(e)}))},updateRecalibrationLinks:function(){var t=this;c.a.get(this.pluginsUri).then((function(e){var a=e.data,i=a.find((function(t){return"org.openflexure.camera_stage_mapping"===t.title}));i?(t.recalibrationLinks=i.links,t.updateCalibrationDataAvailability()):t.recalibrationLinks={}})).catch((function(e){t.modalError(e)}))},onRecalibrateResponse:function(){this.modalNotify("Finished stage-to-camera calibration."),this.updateSettings()}}},Te=$e,Ee=(a("7a19"),Object(h["a"])(Te,Se,xe,!1,null,null,null)),Oe=Ee.exports,Pe={name:"CSMSettings",components:{CSMCalibrationSettings:Oe,miniStreamDisplay:se},props:{showExtraSettings:{type:Boolean,required:!1,default:!0}},data:function(){return{settings:null,recalibrationLinks:{},isCalibrating:!1,dataAvailable:!1}},computed:{settingsUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/instrument/settings")},pluginsUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/extensions")}},mounted:function(){this.updateSettings(),this.updateRecalibrationLinks()},methods:{updateSettings:function(){var t=this;c.a.get(this.settingsUri).then((function(e){t.settings=e.data.extensions["org.openflexure.camera_stage_mapping"]})).catch((function(e){t.modalError(e),t.settings={}}))},updateCalibrationDataAvailability:function(){var t=this;"get_calibration"in this.recalibrationLinks&&c.a.get(this.recalibrationLinks.get_calibration.href).then((function(e){0===Object.keys(e.data).length?t.dataAvailable=!1:t.dataAvailable=!0})).catch((function(e){t.modalError(e)}))},getCalibrationData:function(){var t=this;c.a.get(this.recalibrationLinks.get_calibration.href).then((function(t){if(t.data!={}){var e=JSON.stringify(t.data),a=window.URL.createObjectURL(new Blob([e])),i=document.createElement("a");i.href=a,i.setAttribute("download","csm_calibration.json"),document.body.appendChild(i),i.click()}})).catch((function(e){t.modalError(e)}))},updateRecalibrationLinks:function(){var t=this;c.a.get(this.pluginsUri).then((function(e){var a=e.data,i=a.find((function(t){return"org.openflexure.camera_stage_mapping"===t.title}));i?(t.recalibrationLinks=i.links,t.updateCalibrationDataAvailability()):t.recalibrationLinks={}})).catch((function(e){t.modalError(e)}))},onRecalibrateResponse:function(){this.modalNotify("Finished stage-to-camera calibration."),this.updateSettings()},onRecalibrateError:function(t){this.modalError(t)}}},Ae=Pe,je=(a("140f"),Object(h["a"])(Ae,we,Ce,!1,null,null,null)),Ie=je.exports,Ue=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"uk-width-large",attrs:{id:"stageSettings"}},["MissingStage"===t.stageType?a("div",{staticClass:"uk-text-danger"},[a("b",[t._v("No stage connected")])]):a("div",[a("h3",[t._v("Stage settings")]),a("form",{on:{submit:function(e){return e.preventDefault(),t.setStageType(e)}}},[a("div",{staticClass:"uk-margin-small-bottom"},[a("h4",[t._v("Stage geometry")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.stageType,expression:"stageType"}],staticClass:"uk-select uk-margin-small-top",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.stageType=e.target.multiple?a:a[0]}}},[a("option",{attrs:{value:"SangaStage"}},[t._v("SangaStage (Standard)")]),a("option",{attrs:{value:"SangaDeltaStage"}},[t._v(" SangaStage (Delta)")])]),a("button",{staticClass:"uk-button uk-button-primary uk-margin-small uk-width-1-1",attrs:{type:"submit"}},[t._v(" Change stage geometry ")])])]),a("form",{on:{submit:function(e){return e.preventDefault(),t.applySettingsRequest(e)}}},[a("div",{staticClass:"uk-margin-small-bottom"},[a("h4",[t._v("Backlash compensation")]),a("p",{staticClass:"uk-margin-remove"},[t._v(" Backlash compentation causes movements to overshoot by that number of motor steps, reducing the effect of mechanical backlash. ")]),a("div",{staticClass:"uk-grid-small uk-child-width-1-3 uk-margin-small-bottom",attrs:{"uk-grid":""}},[a("div",[a("label",{staticClass:"uk-form-label",attrs:{for:"form-stacked-text"}},[t._v("x")]),a("div",{staticClass:"uk-form-controls"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.backlash.x,expression:"backlash.x"}],staticClass:"uk-input uk-form-small",attrs:{type:"number"},domProps:{value:t.backlash.x},on:{input:function(e){e.target.composing||t.$set(t.backlash,"x",e.target.value)}}})])]),a("div",[a("label",{staticClass:"uk-form-label",attrs:{for:"form-stacked-text"}},[t._v("y")]),a("div",{staticClass:"uk-form-controls"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.backlash.y,expression:"backlash.y"}],staticClass:"uk-input uk-form-small",attrs:{type:"number"},domProps:{value:t.backlash.y},on:{input:function(e){e.target.composing||t.$set(t.backlash,"y",e.target.value)}}})])]),a("div",[a("label",{staticClass:"uk-form-label",attrs:{for:"form-stacked-text"}},[t._v("z")]),a("div",{staticClass:"uk-form-controls"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.backlash.z,expression:"backlash.z"}],staticClass:"uk-input uk-form-small",attrs:{type:"number"},domProps:{value:t.backlash.z},on:{input:function(e){e.target.composing||t.$set(t.backlash,"z",e.target.value)}}})])])]),a("h4",[t._v("Settle time")]),void 0!==t.settle_time?a("div",[a("p",{staticClass:"uk-margin-small-bottom"},[t._v(" When moving or scanning, captures will be delayed by the settle time (in seconds) to reduce motion blur. ")]),a("div",{staticClass:"uk-form-controls"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.settle_time,expression:"settle_time"}],staticClass:"uk-input uk-form-small",attrs:{type:"number",step:"0.1"},domProps:{value:t.settle_time},on:{input:function(e){e.target.composing||(t.settle_time=e.target.value)}}})])]):t._e(),a("button",{staticClass:"uk-button uk-button-primary uk-margin-small uk-width-1-1",attrs:{type:"submit"}},[t._v(" Apply Settings ")])])])])])},De=[],Le={name:"StageSettings",components:{},data:function(){return{stageType:"MissingStage",backlash:{x:void 0,y:void 0,z:void 0},settle_time:void 0}},computed:{settingsUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/instrument/settings")},stageTypeUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/instrument/stage/type")}},mounted:function(){this.getStageType(),this.updateSettings()},methods:{updateSettings:function(){var t=this;c.a.get(this.settingsUri).then((function(e){var a=e.data.stage;t.backlash.x=a.backlash.x,t.backlash.y=a.backlash.y,t.backlash.z=a.backlash.z,t.settle_time=a.settle_time})).catch((function(e){t.modalError(e)}))},applySettingsRequest:function(){var t=this,e={stage:{backlash:this.backlash}};c.a.put(this.settingsUri,e).then((function(){t.updateSettings(),t.modalNotify("Stage settings applied.")})).catch((function(e){t.modalError(e)}))},getStageType:function(){var t=this;c.a.get(this.stageTypeUri).then((function(e){t.stageType=e.data})).catch((function(e){t.modalError(e)}))},setStageType:function(){var t=this;c.a.put(this.stageTypeUri,this.stageType,{headers:{"Content-Type":"application/json"}}).then((function(e){t.stageType=e.data,t.modalNotify("Stage geometry changed.")})).catch((function(e){t.modalError(e)}))}}},Re=Le,ze=Object(h["a"])(Re,Ue,De,!1,null,null,null),Me=ze.exports,Ne={name:"SettingsContent",components:{streamSettings:Mt,cameraSettings:ue,stageSettings:Me,microscopeSettings:Bt,CSMSettings:Ie,appSettings:fe,featuresSettings:_e,tabIcon:b,tabContent:S},data:function(){return{selected:"display",currentTab:"display"}},methods:{setTab:function(t,e){this.currentTab!=e&&(this.currentTab=e)}}},qe=Ne,Fe=(a("6fc1"),Object(h["a"])(qe,jt,It,!1,null,"3fa7537e",null)),Ve=Fe.exports,We=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"uk-height-1-1 uk-margin-remove uk-padding-remove",attrs:{"uk-grid":""}},[a("div",{staticClass:"control-component"},[t.frame?a("vue-friendly-iframe",{attrs:{src:t.frame.href}}):t.forms?t._l(t.forms,(function(e){return a("div",{key:(e.route+"/"+e.name).replace(/\s+/g,"-").toLowerCase(),staticClass:"uk-height-1-1 uk-width-1-1"},[a("JsonForm",t._g({attrs:{name:e.name,route:e.route,"is-task":e.isTask,"submit-label":e.submitLabel,schema:e.schema,"emit-on-response":e.emitOnResponse}},t.$listeners))],1)})):t._e()],2),a("div",{staticClass:"view-component uk-width-expand"},["gallery"==t.viewPanel?a("galleryContent"):"settings"==t.viewPanel?a("settingsContent"):a("streamDisplay")],1)])},Be=[],Ge=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"uk-padding-small"},[a("div",{staticClass:"uk-flex"},[a("div",{staticClass:"uk-text-bold uk-text-uppercase uk-width-expand"},[t._v(" "+t._s(t.name)+" ")]),a("a",{staticClass:"uk-icon uk-width-auto",attrs:{href:"#"},on:{click:function(e){return t.updateForm()}}},[a("i",{staticClass:"material-icons"},[t._v("cached")])])]),a("form",{ref:"formContainer",staticClass:"uk-form-stacked",on:{submit:function(t){t.preventDefault()}}},[t._l(t.schema,(function(e,i){return a("div",{key:i},[Array.isArray(e)?a("div",{staticClass:"uk-grid-small uk-width-1-1 uk-child-width-expand",attrs:{"uk-grid":""}},t._l(e,(function(e,i){return a("div",{key:i},[a(e.fieldType,t._b({tag:"component",model:{value:t.formData[e.name],callback:function(a){t.$set(t.formData,e.name,a)},expression:"formData[subfield.name]"}},"component",e,!1))],1)})),0):t._e(),a(e.fieldType,t._b({tag:"component",model:{value:t.formData[e.name],callback:function(a){t.$set(t.formData,e.name,a)},expression:"formData[field.name]"}},"component",e,!1))],1)})),t.isTask?a("div",{staticClass:"uk-margin"},[a("taskSubmitter",{attrs:{"submit-url":t.submitApiUri,"submit-data":t.formData,"submit-label":t.submitLabel},on:{submit:t.onTaskSubmit,response:t.onTaskResponse,error:t.onTaskError}})],1):a("div",{staticClass:"uk-margin"},[a("button",{staticClass:"uk-button uk-button-primary uk-width-1-1",attrs:{type:"button"},on:{click:function(e){return t.newQuickRequest(t.formData)}}},[t._v(" "+t._s(t.submitLabel)+" ")])])],2)])},He=[],Ze=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("label",{staticClass:"uk-form-label"},[t._v(t._s(t.label))]),a("input",t._b({staticClass:"uk-input uk-form-small",attrs:{type:"number",name:t.name,placeholder:t.placeholder},domProps:{value:t.value},on:{input:function(e){t.$emit("input",Number(e.target.value))}}},"input",t.$attrs,!1))])},Je=[],Ke=(a("c5f6"),{name:"NumberInput",props:{value:{type:Number,required:!1,default:0},placeholder:{type:Number,required:!1,default:0},name:{type:String,required:!0},label:{type:String,required:!0}}}),Ye=Ke,Xe=Object(h["a"])(Ye,Ze,Je,!1,null,"687d2688",null),Qe=Xe.exports,ta=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("label",{staticClass:"uk-form-label"},[t._v(t._s(t.label))]),a("select",t._b({staticClass:"uk-select uk-form-small",domProps:{value:t.value},on:{input:function(e){return t.$emit("input",e.target.value)}}},"select",t.$attrs,!1),t._l(t.options,(function(e){return a("option",{key:e},[t._v(" "+t._s(e)+" ")])})),0)])},ea=[],aa={name:"SelectList",props:{value:{type:String,required:!1,default:""},options:{type:Array,required:!0},name:{type:String,required:!0},label:{type:String,required:!0}}},ia=aa,na=Object(h["a"])(ia,ta,ea,!1,null,"4544c2fa",null),sa=na.exports,ra=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.label?a("label",{staticClass:"uk-form-label"},[t._v(t._s(t.label))]):t._e(),a("input",t._b({staticClass:"uk-input uk-form-small",attrs:{type:"text",name:t.name,placeholder:t.placeholder},domProps:{value:t.value},on:{input:function(e){return t.$emit("input",e.target.value)}}},"input",t.$attrs,!1))])},oa=[],la={name:"TextInput",props:{placeholder:{type:String,required:!1,default:null},label:{type:String,required:!1,default:null},name:{type:String,required:!0},value:{type:String,required:!1,default:""}}},ua=la,ca=Object(h["a"])(ua,ra,oa,!1,null,"4f9bd98f",null),da=ca.exports,ma=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("p",{domProps:{innerHTML:t._s(t.content)}})])},pa=[],va={name:"HtmlBlock",props:{label:{type:String,required:!1,default:""},name:{type:String,required:!0},content:{type:String,required:!0}}},fa=va,ha=Object(h["a"])(fa,ma,pa,!1,null,"307d1b68",null),ga=ha.exports,ba=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("label",[t._v(t._s(t.label))]),a("div",{staticClass:"uk-form-controls"},t._l(t.options,(function(e){return a("div",{key:e},[a("label",[a("input",{staticClass:"uk-radio",attrs:{type:"radio",name:t.name},domProps:{value:e,checked:t.value==e},on:{input:function(e){return t.$emit("input",e.target.value)}}}),t._v(" "+t._s(e))])])})),0)])},ka=[],ya={name:"RadioList",props:{value:{type:String,required:!1,default:""},options:{type:Array,required:!0},name:{type:String,required:!0},label:{type:String,required:!0}}},_a=ya,wa=Object(h["a"])(_a,ba,ka,!1,null,"2f35aa31",null),Ca=wa.exports,Sa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("label",[t._v(t._s(t.label))]),a("div",{staticClass:"uk-form-controls"},t._l(t.options,(function(e){return a("div",{key:e},[a("label",[a("input",t._b({staticClass:"uk-checkbox",attrs:{type:"checkbox"},domProps:{value:e,checked:t.value&&t.value.includes(e)},on:{change:function(e){return t.updateValue(e.target)}}},"input",t.$attrs,!1)),t._v(" "+t._s(e)+" ")])])})),0)])},xa=[],$a={name:"CheckList",props:{value:{type:Array,required:!1,default:function(){return[]}},options:{type:Array,required:!0},name:{type:String,required:!0},label:{type:String,required:!0}},methods:{updateValue:function(t){var e=null!=this.value?Object(K["a"])(this.value):[];t.checked?e.includes(t.value)||e.push(t.value):e.includes(t.value)&&(e=e.filter((function(e){return e!=t.value}))),this.$emit("input",e)}}},Ta=$a,Ea=Object(h["a"])(Ta,Sa,xa,!1,null,"5900d91d",null),Oa=Ea.exports,Pa={name:"JsonForm",components:{numberInput:Qe,selectList:sa,textInput:da,htmlBlock:ga,radioList:Ca,checkList:Oa,tagList:tt,keyvalList:et["a"],taskSubmitter:O["a"]},props:{name:{type:String,required:!1,default:"Plugin"},schema:{type:Array,required:!0},route:{type:String,required:!0},isTask:{type:Boolean,required:!1,default:!1},submitLabel:{type:String,required:!1,default:"Submit"},emitOnResponse:{type:String,required:!1,default:null}},data:function(){return{formData:{}}},computed:{pluginApiUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/extensions")},submitApiUri:function(){return this.pluginApiUri+this.route}},watch:{schema:function(){this.updateFormValues()}},created:function(){this.initialiseFormData()},methods:{initialiseFormData:function(){var t=!0,e=!1,a=void 0;try{for(var i,n=this.schema[Symbol.iterator]();!(t=(i=n.next()).done);t=!0){var s=i.value;if(Array.isArray(s)){var r,o=!0,l=!1,u=void 0;try{for(var c,d=s[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var m=c.value;r=m.value?m.value:m.default?m.default:null,this.$set(this.formData,m.name,r)}}catch(p){l=!0,u=p}finally{try{o||null==d.return||d.return()}finally{if(l)throw u}}}else r=s.value?s.value:s.default?s.default:null,this.$set(this.formData,s.name,r)}}catch(p){e=!0,a=p}finally{try{t||null==n.return||n.return()}finally{if(e)throw a}}},updateFormValues:function(){var t=!0,e=!1,a=void 0;try{for(var i,n=this.schema[Symbol.iterator]();!(t=(i=n.next()).done);t=!0){var s=i.value;if(Array.isArray(s)){var r=!0,o=!1,l=void 0;try{for(var u,c=s[Symbol.iterator]();!(r=(u=c.next()).done);r=!0){var d=u.value;d.value&&this.$set(this.formData,d.name,d.value)}}catch(m){o=!0,l=m}finally{try{r||null==c.return||c.return()}finally{if(o)throw l}}}else s.value&&this.$set(this.formData,s.name,s.value)}}catch(m){e=!0,a=m}finally{try{t||null==n.return||n.return()}finally{if(e)throw a}}},updateForm:function(){this.$emit("reloadForms")},onSubmissionCompleted:function(){this.emitOnResponse&&this.$root.$emit(this.emitOnResponse),this.updateForm()},newQuickRequest:function(t){var e=this;c.a.post(this.submitApiUri,t).then((function(){e.onSubmissionCompleted()})).catch((function(t){e.modalError(t)}))},onTaskSubmit:function(){},onTaskResponse:function(){this.onSubmissionCompleted()},onTaskError:function(t){this.modalError(t)}}},Aa=Pa,ja=(a("4f3e"),Object(h["a"])(Aa,Ge,He,!1,null,"c377df1c",null)),Ia=ja.exports,Ua=a("b34a"),Da={name:"ExtensionContent",components:{JsonForm:Ia,streamDisplay:M,galleryContent:Ua["default"],settingsContent:Ve},props:{forms:{type:Array,required:!1,default:function(){return[]}},frame:{type:Object,required:!1,default:null},viewPanel:{type:String,required:!1,default:"stream"}}},La=Da,Ra=(a("d581"),Object(h["a"])(La,We,Be,!1,null,null,null)),za=Ra.exports,Ma=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"uk-height-1-1 view-component"},[a("div",{staticClass:"uk-padding-small"},[a("statusPane",{staticClass:"uk-width-large"})],1),t._m(0),a("div",{staticClass:"uk-padding-small"},[a("h2",[t._v("Developer tools")]),a("devTools",{staticClass:"uk-width-large"})],1)])},Na=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"uk-padding-small"},[a("h2",[t._v("Links")]),a("a",{staticClass:"uk-link",attrs:{target:"_blank",href:"https://gitlab.com/openflexure/openflexure-microscope-server/-/issues"}},[t._v("Report an issue")])])}],qa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("form",{staticClass:"uk-form-stacked",attrs:{action:"",method:"GET"},on:{submit:t.overrideAPIHost}},[a("label",{staticClass:"uk-form-label"},[t._v("Override API origin")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.newOrigin,expression:"newOrigin"}],staticClass:"uk-input",attrs:{name:"overrideOrigin",type:"text"},domProps:{value:t.newOrigin},on:{input:function(e){e.target.composing||(t.newOrigin=e.target.value)}}}),a("label",{staticClass:"uk-form-label"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.reloadWhenOverridingOrigin,expression:"reloadWhenOverridingOrigin"}],staticClass:"uk-input uk-checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.reloadWhenOverridingOrigin)?t._i(t.reloadWhenOverridingOrigin,null)>-1:t.reloadWhenOverridingOrigin},on:{change:function(e){var a=t.reloadWhenOverridingOrigin,i=e.target,n=!!i.checked;if(Array.isArray(a)){var s=null,r=t._i(a,s);i.checked?r<0&&(t.reloadWhenOverridingOrigin=a.concat([s])):r>-1&&(t.reloadWhenOverridingOrigin=a.slice(0,r).concat(a.slice(r+1)))}else t.reloadWhenOverridingOrigin=n}}}),t._v(" Reload web app with new origin ")]),a("button",{staticClass:"uk-button uk-button-default uk-margin-small"},[t._v(" Apply ")])]),a("form",{staticClass:"uk-form-stacked",on:{submit:function(e){return e.preventDefault(),t.resetTour(e)}}},[a("label",{staticClass:"uk-form-label"},[t._v("Re-run tour on next load")]),a("button",{staticClass:"uk-button uk-button-default uk-margin-small"},[t._v(" Reset ")])])])},Fa=[],Va={name:"DevTools",components:{},data:function(){return{newOrigin:this.$store.state.origin,reloadWhenOverridingOrigin:!0}},mounted:function(){localStorage.overrideOrigin?this.newOrigin=localStorage.overrideOrigin:this.newOrigin="http://microscope.local:5000"},methods:{overrideAPIHost:function(t){localStorage.overrideOrigin=this.newOrigin,this.reloadWhenOverridingOrigin||(this.$store.commit("changeOrigin",this.newOrigin),t.preventDefault())},resetTour:function(){this.setLocalStorageObj("completedTour",!1)}}},Wa=Va,Ba=(a("6d04"),Object(h["a"])(Wa,qa,Fa,!1,null,"eaa5449e",null)),Ga=Ba.exports,Ha=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"host-input"},[t.configuration?a("div",[a("div",[a("div",{staticClass:"uk-margin-small-bottom"},[a("b",[t._v("API origin:")]),a("br"),t._v(" "+t._s(t.$store.state.origin)+" "),a("br"),a("b",[t._v("API URL:")]),a("br"),t._v(" "+t._s(t.$store.getters.uriV2)+" ")])]),a("hr"),t.settings?a("div",[a("b",[t._v("Device name:")]),t._v(" "),a("br"),t._v(" "+t._s(t.settings.name)+" ")]):t._e(),a("div",[a("b",[t._v("Server version:")]),t._v(" "),a("br"),t._v(" "+t._s(t.configuration.application.version)+" ")]),a("hr"),a("div",{staticClass:"uk-margin-small-bottom"},[a("b",[t._v("Camera:")]),a("br"),"MissingCamera"!=t.configuration.camera.type?a("div",[t._v(" "+t._s(t.configuration.camera.type)+" ")]):a("div",{staticClass:"uk-text-danger"},[a("b",[t._v("No camera connected")])])]),a("div",[a("b",[t._v("Stage:")]),a("br"),"MissingStage"!=t.configuration.stage.type?a("div",[t._v(" "+t._s(t.configuration.stage.type)+" ")]):a("div",{staticClass:"uk-text-danger"},[a("b",[t._v("No stage connected")])])]),a("hr"),a("div",{staticClass:"uk-grid-small uk-child-width-1-2",attrs:{"uk-grid":""}},[a("div",[a("button",{directives:[{name:"show",rawName:"v-show",value:"shutdown"in t.systemActionLinks,expression:"'shutdown' in systemActionLinks"}],staticClass:"uk-button uk-button-danger uk-float-right uk-margin uk-margin-remove-top uk-width-1-1",on:{click:t.shutdownRequest}},[t._v(" Shutdown ")])]),a("div",[a("button",{directives:[{name:"show",rawName:"v-show",value:"reboot"in t.systemActionLinks,expression:"'reboot' in systemActionLinks"}],staticClass:"uk-button uk-button-danger uk-float-right uk-margin uk-margin-remove-top uk-width-1-1",on:{click:t.rebootRequest}},[t._v(" Restart ")])])])]):t.$store.state.waiting?a("div",[t._v(" Loading... ")]):t.$store.state.error?a("div",[a("b",[t._v("Error:")]),t._v(" "+t._s(t.$store.state.error)+" ")]):a("div",[t._v("No active connection")])])},Za=[],Ja={name:"StatusPane",components:{},data:function(){return{configuration:null,settings:null,systemActionLinks:{}}},computed:{settingsUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/instrument/settings")},configurationUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/instrument/configuration")},rootUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2")}},mounted:function(){this.updateConfiguration(),this.updateSettings(),this.updateSystemActions()},methods:{updateConfiguration:function(){var t=this;c.a.get(this.configurationUri).then((function(e){t.configuration=e.data})).catch((function(e){t.modalError(e)}))},updateSettings:function(){var t=this;c.a.get(this.settingsUri).then((function(e){t.settings=e.data})).catch((function(e){t.modalError(e)}))},updateSystemActions:function(){var t=this;c.a.get(this.rootUri).then((function(e){"RebootAPI"in e.data.actions?t.$set(t.systemActionLinks,"reboot","".concat(t.$store.getters.baseUri,"/api/v2/actions/system/reboot/")):delete t.systemActionLinks.reboot,"ShutdownAPI"in e.data.actions?t.$set(t.systemActionLinks,"shutdown","".concat(t.$store.getters.baseUri,"/api/v2/actions/system/shutdown/")):delete t.systemActionLinks.shutdown})).catch((function(e){t.modalError(e)}))},shutdownRequest:function(){var t=this;this.modalConfirm("Shut down microscope?").then((function(){"shutdown"in t.systemActionLinks&&(t.$store.commit("resetState"),c.a.post(t.systemActionLinks.shutdown).catch((function(){})))}),(function(){}))},rebootRequest:function(){var t=this;this.modalConfirm("Restart microscope?").then((function(){"reboot"in t.systemActionLinks&&(t.$store.commit("resetState"),c.a.post(t.systemActionLinks.reboot).catch((function(){})))}),(function(){}))}}},Ka=Ja,Ya=Object(h["a"])(Ka,Ha,Za,!1,null,"6bc1551d",null),Xa=Ya.exports,Qa={name:"AboutContent",components:{devTools:Ga,statusPane:Xa}},ti=Qa,ei=Object(h["a"])(ti,Ma,Na,!1,null,null,null),ai=ei.exports,ii=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:t.visibilityChanged,expression:"visibilityChanged"}],staticClass:"uk-padding uk-padding-remove-top"},[a("nav",{staticClass:"logging-navbar uk-navbar-container uk-navbar-transparent",attrs:{"uk-navbar":"mode: click"}},[a("div",{staticClass:"uk-navbar-left uk-padding-remove-top uk-padding-remove-bottom"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.filterLevel,expression:"filterLevel"}],staticClass:"uk-select",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.filterLevel=e.target.multiple?a:a[0]}}},t._l(t.allLevels,(function(e){return a("option",{key:e},[t._v(t._s(e))])})),0)]),a("div",{staticClass:"uk-navbar-right"},[a("div",{staticClass:"uk-grid"},[a("div",[a("button",{staticClass:"uk-button uk-button-default uk-width-1-1",attrs:{type:"button"},on:{click:function(e){return t.updateLogs()}}},[t._v(" Refresh Logs ")])]),a("div",[a("a",{staticClass:"uk-button uk-button-default",attrs:{href:t.logFileURI,download:""}},[t._v("Download Log File")])])])])]),a("div",{staticClass:"uk-width-xlarge uk-align-center"},[t._l(t.pagedItems,(function(e){return a("div",{key:e.timestamp,staticClass:"logging-entry",class:{"uk-alert-warning uk-alert":"WARNING"==e.data.levelname,"uk-alert-danger uk-alert":"ERROR"==e.data.levelname},attrs:{"uk-alert":""}},[a("b",[t._v(t._s(t.formatDateTime(e.data.created)))]),a("div",{staticClass:"logging-message"},[t._v(t._s(t.formatMessage(e)))])])})),a("Paginate",{attrs:{"page-count":t.numberOfPages,"page-range":3,"margin-pages":1,"container-class":"uk-pagination uk-flex-center","prev-text":"Prev","next-text":"Next","page-class":"page-item","active-class":"uk-active","disabled-class":"uk-disabled","click-handler":t.scrollToTop()},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}})],2)])},ni=[],si=a("8832"),ri=a.n(si),oi={name:"LoggingContent",components:{Paginate:ri.a},data:function(){return{maxitems:20,page:1,logs:[],allLevels:["DEBUG","INFO","WARNING","ERROR","CRITICAL"],filterLevel:"WARNING"}},computed:{filteredLevels:function(){var t=this.allLevels.indexOf(this.filterLevel);return this.allLevels.slice(t,-1)},filteredItems:function(){var t=[],e=!0,a=!1,i=void 0;try{for(var n,s=this.logs[Symbol.iterator]();!(e=(n=s.next()).done);e=!0){var r=n.value;this.filteredLevels.includes(r.data.levelname)&&t.push(r)}}catch(o){a=!0,i=o}finally{try{e||null==s.return||s.return()}finally{if(a)throw i}}return t},loggingUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/events/logging")},logFileURI:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/log")},pagedItems:function(){var t=(this.page-1)*this.maxitems;return this.filteredItems.slice(t,t+this.maxitems)},numberOfPages:function(){return Math.floor(this.filteredItems.length/this.maxitems)}},mounted:function(){this.updateLogs()},methods:{scrollToTop:function(){var t=document.querySelector("#container-left");t&&(t.scrollTop=0)},visibilityChanged:function(t){t&&this.updateLogs()},updateLogs:function(){var t=this;c.a.get(this.loggingUri).then((function(e){t.logs=e.data.reverse()})).catch((function(e){t.modalError(e)}))},formatDateTime:function(t){var e=new Date(t);return e.toLocaleDateString()+" "+e.toLocaleTimeString()},formatMessage:function(t){return t.data.levelname+": "+t.data.message}}},li=oi,ui=(a("d10d"),Object(h["a"])(li,ii,ni,!1,null,"66599c2c",null)),ci=ui.exports,di=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"calibrationModalEl",attrs:{id:"modal-example","uk-modal":"bg-close: false;"}},[t.ready?a("div",{staticClass:"uk-modal-dialog uk-modal-body"},[a("h2",{staticClass:"uk-modal-title"},[t._v("Microscope Calibration")]),a("div",{directives:[{name:"show",rawName:"v-show",value:0==t.stepValue,expression:"stepValue == 0"}]},[t._m(0),a("p",[t._v(" Your microscope will still function, however some functionality will be limited, and image quality will likely suffer. ")]),t._m(1)]),a("div",{directives:[{name:"show",rawName:"v-show",value:1==t.stepValue,expression:"stepValue == 1"}]},[a("h3",[t._v("Lens-shading")]),t.isLSTCalibrated?a("div",[t._m(2)]):a("div",[t._m(3),t._m(4),1==t.stepValue?a("miniStreamDisplay",{staticClass:"mini-preview"}):t._e(),a("p",[t._v("Once you're ready, click auto-calibrate.")]),a("cameraCalibrationSettings",{attrs:{"show-extra-settings":!1}})],1)]),a("div",{directives:[{name:"show",rawName:"v-show",value:2==t.stepValue,expression:"stepValue == 2"}]},[a("h3",[t._v("Camera-stage mapping")]),t.isCSMCalibrated?a("div",[t._m(5)]):t.canCSMCalibrated?a("div",[t._m(7),t._m(8),2==t.stepValue?a("miniStreamDisplay",{staticClass:"mini-preview"}):t._e(),a("p",[t._v("Once you're ready, click auto-calibrate.")]),a("CSMCalibrationSettings",{attrs:{"show-extra-settings":!1}})],1):a("div",[t._m(6)])]),a("div",{directives:[{name:"show",rawName:"v-show",value:3==t.stepValue,expression:"stepValue == 3"}]},[t._m(9),a("p",[t._v(" Click Finish to return to your microscope, or Restart to re-run the calibration routine ")])]),a("p",{staticClass:"uk-text-right"},[a("button",{directives:[{name:"show",rawName:"v-show",value:0==t.stepValue,expression:"stepValue == 0"}],staticClass:"uk-button uk-button-default uk-modal-close",attrs:{type:"button"}},[t._v(" Cancel ")]),a("button",{directives:[{name:"show",rawName:"v-show",value:3==t.stepValue,expression:"stepValue == 3"}],staticClass:"uk-button uk-button-default",attrs:{type:"button"},on:{click:function(e){t.stepValue=0}}},[t._v(" Restart ")]),a("button",{directives:[{name:"show",rawName:"v-show",value:t.stepValue<3,expression:"stepValue < 3"}],staticClass:"uk-button uk-button-primary uk-margin-left",attrs:{type:"button"},on:{click:function(e){return t.increment()}}},[t._v(" Next ")]),a("button",{directives:[{name:"show",rawName:"v-show",value:3==t.stepValue,expression:"stepValue == 3"}],staticClass:"uk-button uk-button-primary uk-margin-left",attrs:{type:"button"},on:{click:function(e){return t.hide()}}},[t._v(" Finish ")])])]):t._e()])},mi=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",[a("b",[t._v("Some important microscope calibration data is currently missing.")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",[a("b",[t._v("Click Next to begin microscope calibration.")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",[a("b",[t._v("Your lens-shading table has already been calibrated. Click Next to move on.")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",[a("b",[t._v("Follow the important steps below before starting lens-shading calibration!")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",{staticClass:"uk-list uk-list-bullet"},[a("li",[t._v("Remove any samples from your microscope")]),a("li",[t._v("Ensure your illumination is on and properly fixed in place")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",[a("b",[t._v("Your camera-stage mapping has already been calibrated. Click Next to move on.")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",[a("b",[t._v("No stage connected. Please skip this step, or connect a valid stage, then reboot your microscope.")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",[a("b",[t._v("Follow the important steps below before starting camera-stage mapping calibration!")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",{staticClass:"uk-list uk-list-bullet"},[a("li",[t._v("Insert a clearly visible sample to the microscope")]),a("li",[t._v(" Ensure the sample is reasonably well centered on the microscope camera ")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",[a("b",[t._v("Calibration complete")])])}],pi={name:"CalibrationModal",components:{cameraCalibrationSettings:Qt,CSMCalibrationSettings:Oe,miniStreamDisplay:se},props:{availablePlugins:{type:Array,required:!0}},data:function(){return{ready:!1,stepValue:0,settings:{},config:{}}},computed:{settingsUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/instrument/settings")},configUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/instrument/configuration")},availablePluginTitles:function(){return this.availablePlugins.map((function(t){return t.title}))},isCSMCalibrated:function(){return!!this.settings.extensions["org.openflexure.camera_stage_mapping"]},isLSTCalibrated:function(){return!(!this.settings.camera.picamera||!this.settings.camera.picamera.lens_shading_table)},canCSMCalibrated:function(){var t=this.availablePluginTitles.includes("org.openflexure.camera_stage_mapping"),e="MissingStage"!==this.config.stage.type;return e&&t},canLSTCalibrated:function(){var t=this.availablePluginTitles.includes("org.openflexure.calibration.picamera"),e="MissingCamera"!==this.config.camera.type;return e&&t},isUseful:function(){var t=this.canCSMCalibrated&&!this.isCSMCalibrated,e=this.canLSTCalibrated&&!this.isLSTCalibrated;return t||e}},mounted:function(){this.$refs["calibrationModalEl"].addEventListener("hidden",this.onHide)},methods:{show:function(){var t=this;this.getSettings().then((function(){return t.getConfig()})).then((function(){if(t.isUseful){t.ready=!0,t.stepValue=0;var e=t.$refs["calibrationModalEl"];t.showModalElement(e)}else t.onHide()}))},hide:function(){var t=this.$refs["calibrationModalEl"];this.hideModalElement(t),this.ready=!1},onHide:function(){this.$emit("onClose")},getSettings:function(){var t=this;return c.a.get(this.settingsUri).then((function(e){t.settings=e.data})).catch((function(e){t.modalError(e)}))},getConfig:function(){var t=this;return c.a.get(this.configUri).then((function(e){t.config=e.data})).catch((function(e){t.modalError(e)}))},decrement:function(){this.stepValue>0&&(this.stepValue=this.stepValue-1)},increment:function(){if(this.stepValue<3)return this.stepValue=this.stepValue+1,!0}}},vi=pi,fi=(a("4529"),Object(h["a"])(vi,di,mi,!1,null,"2f551ab1",null)),hi=fi.exports;function gi(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function bi(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?gi(Object(a),!0).forEach((function(e){Object(l["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):gi(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var ki=function(){return Promise.resolve().then(a.bind(null,"b34a"))},yi=function(){return a.e("imjoy").then(a.bind(null,"5ccd"))},_i={name:"AppContent",components:{tabIcon:b,tabContent:S,navigateContent:V,captureContent:pt,slideScanContent:xt,viewContent:At,settingsContent:Ve,galleryContent:ki,extensionContent:za,calibrationModal:hi,aboutContent:ai,loggingContent:ci,TabIcon:b,imjoyContent:yi},data:function(){return{plugins:[],currentTab:"view",bottomTabs:[{id:"settings",icon:"settings",component:Ve,class:"uk-margin-auto-top"},{id:"logging",icon:"assignment_late",component:ci},{id:"about",icon:"info",component:ai}]}},computed:bi({pluginsUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/extensions")},pluginsGuiList:function(){for(var t=[],e=0,a=Object.values(this.plugins);e<a.length;e++){var i=a[e];i.meta.gui&&t.push(i.meta.gui)}return t},tabOrder:function(){var t=[],e=!0,a=!1,i=void 0;try{for(var n,s=this.topTabs[Symbol.iterator]();!(e=(n=s.next()).done);e=!0){var r=n.value;t.push(r.id)}}catch(k){a=!0,i=k}finally{try{e||null==s.return||s.return()}finally{if(a)throw i}}var o=!0,l=!1,u=void 0;try{for(var c,d=this.pluginsGuiList[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var m=c.value;t.push(m.id)}}catch(k){l=!0,u=k}finally{try{o||null==d.return||d.return()}finally{if(l)throw u}}var p=!0,v=!1,f=void 0;try{for(var h,g=this.bottomTabs[Symbol.iterator]();!(p=(h=g.next()).done);p=!0){var b=h.value;t.push(b.id)}}catch(k){v=!0,f=k}finally{try{p||null==g.return||g.return()}finally{if(v)throw f}}return t},topTabs:function(){var t=[{id:"view",icon:"visibility",component:At},{id:"gallery",icon:"photo_library",component:ki,divide:!0},{id:"navigate",icon:"gamepad",component:V},{id:"capture",icon:"camera_alt",component:pt,divide:!0}];return this.$store.state.galleryEnabled||(t=t.filter((function(t){return"gallery"!=t.id}))),this.$store.state.IHIEnabled&&t.push({id:"slidescan",icon:"settings_overscan",component:xt,divide:!0}),this.$store.state.imjoyEnabled&&t.push({id:"imjoy",iconURL:"https://imjoy.io/static/img/imjoy-icon.svg",component:yi,divide:!0}),t},currentTabIndex:function(){return this.tabOrder.indexOf(this.currentTab)}},Object(d["b"])("imjoy",{imjoyTabs:"tabs"}),{},Object(d["b"])({imjoyEnabled:"imjoyEnabled"})),created:function(){var t=this;this.$store.getters.ready&&this.updatePlugins().then((function(){t.startModals()}))},mounted:function(){var t=this;this.$root.$on("globalSwitchTab",(function(e){t.currentTab=e})),this.$root.$on("globalIncrementTab",(function(){t.incrementTabBy(1)})),this.$root.$on("globalDecrementTab",(function(){t.incrementTabBy(-1)}))},methods:{updatePlugins:function(){var t=this;return c.a.get(this.pluginsUri).then((function(e){t.plugins=e.data})).catch((function(e){t.modalError(e)}))},setTab:function(t,e){this.currentTab!=e&&(this.currentTab=e)},incrementTabBy:function(t){var e=((this.currentTabIndex+t)%this.tabOrder.length+this.tabOrder.length)%this.tabOrder.length,a=this.tabOrder[e];this.currentTab=a},startModals:function(){this.$refs["calibrationModal"].show()},enterApp:function(){}}},wi=_i,Ci=(a("d271"),Object(h["a"])(wi,r,o,!1,null,"60c75714",null)),Si=Ci.exports,xi=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"uk-flex uk-flex-column uk-flex-center uk-height-1-1"},[t.$store.state.waiting?a("div",{staticClass:"uk-align-center",attrs:{"uk-spinner":"ratio: 3"}}):t._e(),t.$store.state.waiting?a("div",{staticClass:"uk-align-center"},[t._v("Loading...")]):t._e(),a("i",{staticClass:"material-icons uk-align-center error-icon"},[t._v("error_outline")]),t.$store.state.error?a("div",{staticClass:"uk-align-center"},[t._v(" "+t._s(t.$store.state.error)+" ")]):t._e(),a("div",{staticClass:"uk-align-center"},[a("devTools",{staticClass:"uk-width-medium"})],1)])},$i=[],Ti={name:"LoadingContent",components:{devTools:Ga},data:function(){return{}}},Ei=Ti,Oi=(a("8ba2"),Object(h["a"])(Ei,xi,$i,!1,null,"56d8586c",null)),Pi=Oi.exports,Ai=a("8a60");Ai.prototype.stopCallback=function(t,e){return!((" "+e.className+" ").indexOf(" mousetrap ")>-1)&&(!!e.classList.contains("lightbox-link")||("INPUT"==e.tagName||"SELECT"==e.tagName||"TEXTAREA"==e.tagName||e.contentEditable&&"true"==e.contentEditable))};var ji={name:"App",components:{appContent:Si,loadingContent:Pi},data:function(){var t=this;return{appAvailable:!1,arrowKeysDown:{},keyboardManual:[],systemDark:void 0,themeObserver:void 0,tourCallbacks:{onStop:function(){t.setLocalStorageObj("completedTour",!0)}}}},computed:{isSystemDark:function(){return!(!window.matchMedia||!window.matchMedia("(prefers-color-scheme: dark)").matches)},handleTheme:function(){var t=!1;return("dark"==this.$store.state.appTheme||"system"==this.$store.state.appTheme&&this.systemDark)&&(t=!0),{"uk-light":t,"uk-background-secondary":t}},tourSteps:function(){var t={modifiers:{preventOverflow:{boundariesElement:"window"}},placement:"right"};return[{target:"#tour-header",header:{title:"Welcome to the OpenFlexure Microscope"},content:"Click Next to learn how to use your microscope",params:{placement:"bottom"}},{target:"#gallery-tab-icon",header:{title:"Capture gallery"},content:"View and download your microscope images from the gallery tab",params:t},{target:"#navigate-tab-icon",header:{title:"Navigate around your sample"},content:"Move your microscope stage and perform autofocus from the navigate tab",params:t},{target:"#capture-tab-icon",header:{title:"Capture microscope images"},content:"Take images and simple tile scans from the capture tab",params:t},{target:"#settings-tab-icon",header:{title:"Change settings"},content:"Change app and microscope settings, including microscope calibration, from the settings tab",params:t},{target:"#extension-tab-divider",header:{title:"Microscope extensions"},content:"Extensions installed on your microscope will appear below this line",params:t}]}},mounted:function(){var t=this,e=window.matchMedia("(prefers-color-scheme: dark)");e.matches&&(this.systemDark=!0),this.themeObserver=e.addListener((function(e){e.matches?t.systemDark=!0:t.systemDark=!1})),this.checkConnection();var a=this.getLocalStorageObj("completedTour")||!1;a||this.$tours["guidedTour"].start()},created:function(){var t=this;window.addEventListener("beforeunload",this.handleExit),window.addEventListener("wheel",this.wheelMonitor),this.unwatchOriginFunction=this.$store.watch((function(t,e){return e.uriV2}),(function(){t.checkConnection()})),Ai.bind("?",(function(){t.toggleModalElement(t.$refs["keyboardManualModal"])})),Ai.bind(["up","down","left","right"],(function(e){t.arrowKeysDown[e.keyCode]=!0,t.navigateKeyHandler()}),"keydown"),Ai.bind(["up","down","left","right"],(function(e){delete t.arrowKeysDown[e.keyCode]}),"keyup"),this.keyboardManual.push({shortcut:"←↑→↓",description:"Move the microscope stage"}),Ai.bind("pageup",(function(){t.$root.$emit("globalMoveStepEvent",0,0,1)})),Ai.bind("pagedown",(function(){t.$root.$emit("globalMoveStepEvent",0,0,-1)})),this.keyboardManual.push({shortcut:"pgup / pgdn",description:"Move the microscope focus"}),Ai.bind("c",(function(){t.$root.$emit("globalCaptureEvent")})),this.keyboardManual.push({shortcut:"c",description:"Take a capture"}),Ai.bind("a",(function(){t.$root.$emit("globalFastAutofocusEvent")})),this.keyboardManual.push({shortcut:"a",description:"Fast autofocus"}),Ai.bind("shift+down",(function(){t.$root.$emit("globalIncrementTab")})),Ai.bind("shift+up",(function(){t.$root.$emit("globalDecrementTab")})),this.keyboardManual.push({shortcut:"shift+↑ / shift+↓",description:"Switch tab"}),Ai.bind("alt+t",(function(){t.$tours["guidedTour"].start()}))},beforeDestroy:function(){this.themeObserver&&this.themeObserver.disconnect(),window.removeEventListener("wheel",this.wheelMonitor),this.unwatchOriginFunction(),Ai.reset()},methods:{checkConnection:function(){var t=this,e=this.$store.getters.uriV2;this.$store.commit("changeWaiting",!0),c.a.get(e).then((function(){t.$store.commit("setConnected"),t.$store.commit("setErrorMessage",null)})).catch((function(e){t.$store.commit("setErrorMessage",e)})).finally((function(){t.$store.commit("changeWaiting",!1)}))},handleExit:function(){this.$root.$emit("globalTogglePreview",!1)},wheelMonitor:function(t){if(t.target.parentNode.classList.contains("scrollTarget")||t.target.classList.contains("scrollTarget")){var e=t.deltaY/100;this.$root.$emit("globalMoveStepEvent",0,0,e,!1)}},navigateKeyHandler:function(){var t=0,e=0,a=0;37 in this.arrowKeysDown&&(t+=1),39 in this.arrowKeysDown&&(t-=1),38 in this.arrowKeysDown&&(e+=1),40 in this.arrowKeysDown&&(e-=1),this.$root.$emit("globalMoveStepEvent",t,e,a)}}},Ii=ji,Ui=(a("7c55"),Object(h["a"])(Ii,n,s,!1,null,null,null)),Di=Ui.exports;i["a"].use(d["a"]);var Li={namespaced:!0,state:function(){return{tabs:[],openImageMenu:[],openScanMenu:[]}},mutations:{addOpenImageItem:function(t,e){t.openImageMenu.push(e)},addOpenScanItem:function(t,e){t.openScanMenu.push(e)},clearMenus:function(t){t.openImageMenu=[],t.openScanMenu=[]},addTab:function(t,e){t.tabs.push(e)},removeTab:function(t,e){var a=t.tabs.indexOf(e);a>-1?t.tabs.splice(a,1):console.warn("Attempted to remove a non-existing ImJoy tab ".concat(e))},setTabProperty:function(t,e){var a=e.tab,i=e.key,n=e.value;t.tabs=t.tabs.map((function(t){return t.id===a&&(t[i]=n),t}))}},actions:{},getters:{}};function Ri(){var t=new URL(window.location.href),e=t.searchParams.get("overrideOrigin");return e||t.origin}var zi=new d["a"].Store({modules:{imjoy:Li},state:{origin:Ri(),available:!1,waiting:!1,error:"",disableStream:!1,autoGpuPreview:!1,trackWindow:!0,IHIEnabled:!1,imjoyEnabled:!1,galleryEnabled:!0,appTheme:"system",activeStreams:{}},mutations:{changeOrigin:function(t,e){t.origin=e},changeWaiting:function(t,e){t.waiting=e},changeDisableStream:function(t,e){t.disableStream=e},changeAutoGpuPreview:function(t,e){t.autoGpuPreview=e},changeTrackWindow:function(t,e){t.trackWindow=e},changeAppTheme:function(t,e){t.appTheme=e},changeIHIEnabled:function(t,e){t.IHIEnabled=e},changeImjoyEnabled:function(t,e){t.imjoyEnabled=e},changeGalleryEnabled:function(t,e){t.galleryEnabled=e},resetState:function(t){t.waiting=!1,t.available=!1,t.error=null},setConnected:function(t){t.waiting=!1,t.available=!0},setErrorMessage:function(t,e){t.error=e},addStream:function(t,e){t.activeStreams[e]=!0},removeStream:function(t,e){t.activeStreams[e]=!1}},actions:{},getters:{uriV2:function(t){return"".concat(t.origin,"/api/v2")},baseUri:function(t){return t.origin},ready:function(t){return t.available}}}),Mi=a("8323"),Ni=a.n(Mi),qi=a("2536"),Fi=a.n(qi),Vi=a("6c39"),Wi=a.n(Vi),Bi=a("85fe");a("619b");a("2440"),Ni.a.mixin({data:{animation:!1}},"accordion"),i["a"].use(Fi.a),i["a"].use(Wi.a),i["a"].use(Bi["a"]),i["a"].config.productionTip=!1,i["a"].mixin({methods:{modalConfirm:function(t){var e=this;e.$root.$emit("globalTogglePreview",!1);var a=function(a,i){Ni.a.modal.confirm(t,{stack:!0}).then((function(){a()}),(function(){i()})).finally((function(){e.$store.state.autoGpuPreview&&e.$root.$emit("globalTogglePreview",!0)}))};return new Promise(a)},modalNotify:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";Ni.a.notification({message:t,status:e})},modalDialog:function(t,e){Ni.a.modal.dialog('\n        <button class="uk-modal-close-default" type="button" uk-close></button>\n        <div class="uk-modal-header">\n          <h2 class="uk-modal-title">'.concat(t,'</h2>\n        </div>\n        <div class="uk-modal-body">\n          <p>').concat(e,"</p>\n        </div>\n      "),{stack:!0})},modalError:function(t){var e=this.getErrorMessage(t);this.$store.commit("setErrorMessage",e),Ni.a.notification({message:"".concat(e),status:"danger"})},getErrorMessage:function(t){var e="";return e=t.response?t.response.data.message?"".concat(t.response.status,": ").concat(t.response.data.message):"".concat(t.response.status,": ").concat(t.response.data):(t.request,"".concat(t.message)),e},showModalElement:function(t){Ni.a.modal(t).show()},hideModalElement:function(t){Ni.a.modal(t).hide()},toggleModalElement:function(t){Ni.a.modal(t).toggle()},getLocalStorageObj:function(t){if(localStorage.getItem(t))try{return JSON.parse(localStorage.getItem(t))}catch(e){return localStorage.removeItem(t),null}},setLocalStorageObj:function(t,e){var a=JSON.stringify(e);localStorage.setItem(t,a)}}}),new i["a"]({store:zi,render:function(t){return t(Di)}}).$mount("#app")},"5cd7":function(t,e,a){"use strict";a("9f12")},"642d":function(t,e,a){},"6cd3":function(t,e,a){"use strict";a("d3b6")},"6d04":function(t,e,a){"use strict";a("166c")},"6d79":function(t,e,a){},"6edf":function(t,e,a){},"6fc1":function(t,e,a){"use strict";a("fc7f")},"716d":function(t,e,a){},7294:function(t,e,a){},"78fd":function(t,e,a){"use strict";a("7d0b")},"7a19":function(t,e,a){"use strict";a("6edf")},"7c55":function(t,e,a){"use strict";a("2395")},"7d0b":function(t,e,a){},"7e89":function(t,e,a){"use strict";a("0a08")},8357:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:t.visibilityChanged,expression:"visibilityChanged"}],staticClass:"uk-margin-remove uk-padding-remove"},[t.taskStarted?a("div",{ref:"isPollingElement"},[a("div",{staticClass:"progress uk-margin-small"},[t.progress?a("div",{staticClass:"determinate",style:t.barWidthFromProgress}):a("div",{staticClass:"indeterminate"})]),t.canTerminate&&t.taskRunning?a("button",{staticClass:"uk-button uk-button-danger uk-margin-remove uk-float-right uk-width-1-1",attrs:{type:"button"},on:{click:function(e){return t.terminateTask()}}},[t._v(" Cancel ")]):t._e()]):t._e(),a("div",[a("button",{staticClass:"uk-button uk-margin-remove uk-width-1-1",class:[t.buttonPrimary?"uk-button-primary":"uk-button-default"],attrs:{type:"button",hidden:t.taskStarted},on:{click:function(e){return t.bootstrapTask()}}},[t._v(" "+t._s(t.submitLabel)+" ")])])])},n=[],s=(a("ac4d"),a("8a81"),a("ac6a"),a("c5f6"),a("bc3a")),r=a.n(s),o={name:"TaskSubmitter",props:{submitUrl:{type:String,required:!0},submitData:{type:[Object,Array],required:!1,default:function(){return{}}},pollInterval:{type:Number,required:!1,default:1},submitLabel:{type:String,required:!1,default:"Submit"},canTerminate:{type:Boolean,required:!1,default:!0},requiresConfirmation:{type:Boolean,required:!1,default:!1},confirmationMessage:{type:String,required:!1,default:"Start task?"},buttonPrimary:{type:Boolean,required:!1,default:!0},submitOnEvent:{type:String,required:!1,default:null}},data:function(){return{taskId:null,taskUrl:null,progress:null,taskStarted:!1,taskRunning:!1}},computed:{barWidthFromProgress:function(){var t=this.progress<=100?this.progress:100,e="width: ".concat(t,"%");return e}},created:function(){},mounted:function(){var t=this;1!=this.taskStarted&&this.checkExistingTasks(),this.submitOnEvent&&this.$root.$on(this.submitOnEvent,(function(){t.bootstrapTask()}))},beforeDestroy:function(){this.submitOnEvent&&this.$root.$off(this.submitOnEvent)},methods:{visibilityChanged:function(t){t&&1!=this.taskStarted&&this.checkExistingTasks()},checkExistingTasks:function(){var t=this;r.a.get(this.submitUrl).then((function(e){var a=!0,i=!1,n=void 0;try{for(var s,r=e.data[Symbol.iterator]();!(a=(s=r.next()).done);a=!0){var o=s.value;"pending"!=o.status&&"running"!=o.status||(t.taskStarted=!0,t.$emit("taskStarted",t.taskId),t.startPolling(o.id,o.links.self.href))}}catch(l){i=!0,n=l}finally{try{a||null==r.return||r.return()}finally{if(i)throw n}}}))},bootstrapTask:function(){var t=this;this.requiresConfirmation?this.modalConfirm(this.confirmationMessage).then((function(){t.startTask()}),(function(){})):this.startTask()},startTask:function(){var t=this;this.$emit("submit",this.submitData),this.taskStarted=!0,this.$emit("taskStarted",this.taskId),r.a.post(this.submitUrl,this.submitData).then((function(e){return t.startPolling(e.data.id,e.data.href)})).then((function(e){t.$emit("response",e),t.$emit("finished")})).catch((function(e){e||(e=Error("Unknown error")),t.$emit("error",e),t.$emit("finished")})).finally((function(){t.taskRunning=!1,t.taskStarted=!1,t.taskId=null,t.selfUpdate&&t.getFormData()}))},startPolling:function(t,e){if(1!=this.taskRunning)return this.taskId=t,this.taskUrl=e,this.taskRunning=!0,this.$emit("taskRunning",this.taskId),this.pollTask(this.taskId,this.pollInterval)},pollTask:function(t,e){var a=this;e=1e3*e||500;var i=function t(i,n){r.a.get(a.taskUrl).then((function(s){var r=s.data.status;"completed"==r?i(s.data):"error"==r?n(new Error(s.data.output)):"cancelled"==r?n(new Error("Task cancelled")):(a.progress=s.data.progress,setTimeout(t,e,i,n))}))};return new Promise(i)},pollProgress:function(){var t=this;r.a.get(this.taskUrl).then((function(e){t.progress=e.data.progress}))},terminateTask:function(){r.a.delete(this.taskUrl)}}},l=o,u=(a("0e41"),a("2877")),c=Object(u["a"])(l,i,n,!1,null,"6f9b38c7",null);e["a"]=c.exports},8646:function(t,e,a){},"8ba2":function(t,e,a){"use strict";a("8646")},9398:function(t,e,a){},"9f12":function(t,e,a){},b34a:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"galleryDisplay uk-padding uk-padding-remove-top"},[a("nav",{staticClass:"gallery-navbar uk-navbar-container uk-navbar-transparent",attrs:{"uk-navbar":"mode: click"}},[a("div",{staticClass:"uk-navbar-left uk-padding-remove-top uk-padding-remove-bottom"},[a("ul",{staticClass:"uk-navbar-nav"},[a("li",{class:[t.sortDescending?"uk-active":""]},[a("a",{staticClass:"uk-icon",attrs:{href:"#"},on:{click:function(e){t.sortDescending=!0}}},[a("i",{staticClass:"material-icons"},[t._v("keyboard_arrow_down")])])]),a("li",{class:[t.sortDescending?"":"uk-active"]},[a("a",{staticClass:"uk-icon",attrs:{href:"#"},on:{click:function(e){t.sortDescending=!1}}},[a("i",{staticClass:"material-icons"},[t._v("keyboard_arrow_up")])])]),a("li",[a("a",{attrs:{href:"#"}},[t._v("Filter")]),a("div",{staticClass:"uk-navbar-dropdown",class:{"uk-light uk-background-secondary":t.$store.state.darkMode}},[a("ul",{staticClass:"uk-nav uk-navbar-dropdown-nav"},[a("form",{staticClass:"uk-form-stacked"},t._l(t.allTags,(function(e){return a("div",{key:e,staticClass:"uk-margin-small"},[a("label",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.checkedTags,expression:"checkedTags"}],staticClass:"uk-checkbox",attrs:{id:e,checked:"",type:"checkbox"},domProps:{value:e,checked:Array.isArray(t.checkedTags)?t._i(t.checkedTags,e)>-1:t.checkedTags},on:{change:function(a){var i=t.checkedTags,n=a.target,s=!!n.checked;if(Array.isArray(i)){var r=e,o=t._i(i,r);n.checked?o<0&&(t.checkedTags=i.concat([r])):o>-1&&(t.checkedTags=i.slice(0,o).concat(i.slice(o+1)))}else t.checkedTags=s}}}),t._v(" "+t._s(e)+" ")])])})),0)])])])])]),a("div",{staticClass:"uk-navbar-right"},[a("div",{staticClass:"uk-grid"},[a("div",[a("button",{staticClass:"uk-button uk-button-default uk-width-1-1",attrs:{type:"button"},on:{click:function(e){return t.updateCaptures()}}},[t._v(" Refresh Captures ")])]),a("div",[a("ZipDownloader",{attrs:{"capture-ids":Object.keys(t.filteredCaptures)}})],1)])])]),t.$store.getters.ready?a("div",{staticClass:"uk-padding-remove-top",attrs:{"uk-lightbox":"toggle: .lightbox-link"}},[t.galleryFolder?a("div",{staticClass:"gallery-folder-heading uk-flex uk-flex-middle"},[a("a",{staticClass:"uk-icon uk-margin-remove",attrs:{href:"#"},on:{click:function(e){return t.galleryBack()}}},[a("i",{staticClass:"material-icons"},[t._v("arrow_back")])]),a("div",{staticClass:"uk-margin-left"},[a("h3",{staticClass:"uk-margin-remove uk-margin-left"},[a("b",[t._v("SCAN")]),t._v(" "+t._s(t.allScans[t.galleryFolder].name)+" ")])])]):t._e(),a("div",{staticClass:"gallery-grid"},t._l(t.pagedItems,(function(e){return a("div",{key:e.id},["isScan"in e?a("scanCard",{attrs:{id:e.id,name:e.name,time:e.time,tags:e.tags,type:e.type,captures:e.captures,thumbnail:e.thumbnail},on:{selectFolder:t.selectFolder}}):a("captureCard",{attrs:{id:e.id,links:e.links,name:e.name,format:e.format,path:e.path,time:e.time,tags:e.tags,annotations:e.annotations},on:{"update:tags":function(t){e.tags=t},"update:annotations":function(t){e.annotations=t}}})],1)})),0),a("Paginate",{attrs:{"page-count":t.numberOfPages,"page-range":3,"margin-pages":1,"container-class":"uk-pagination uk-flex-center","prev-text":"Prev","next-text":"Next","page-class":"page-item","active-class":"uk-active","disabled-class":"uk-disabled","click-handler":t.scrollToTop()},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}})],1):t._e()])},n=[],s=(a("456d"),a("8615"),a("2fdb"),a("7f7f"),a("6762"),a("ac4d"),a("8a81"),a("ac6a"),a("55dd"),a("bc3a")),r=a.n(s),o=a("8832"),l=a.n(o),u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"capture-card uk-card uk-card-default uk-padding-remove uk-width-medium",class:{"uk-card-secondary":t.$store.state.darkMode}},[a("div",{staticClass:"uk-card-media-top"},[a("a",{staticClass:"lightbox-link",attrs:{href:t.imgURL,"data-caption":t.name}},[a("img",{staticClass:"uk-width-1-1",attrs:{"data-src":t.thumbURL,alt:t.id,width:"300",height:"225","uk-img":""}})])]),a("div",{staticClass:"uk-card-body uk-padding-small"},[a("div",{staticClass:"uk-width-1-1 uk-margin-small uk-margin-remove-left uk-margin-remove-right",attrs:{"uk-grid":""}},[a("div",{staticClass:"uk-margin-remove-top uk-padding-remove uk-width-expand"},[t._v(" "+t._s(t.name)+" ")]),a("div",{staticClass:"uk-margin-remove-top uk-padding-remove uk-width-auto"},[a("a",{staticClass:"uk-icon",attrs:{href:"#"},on:{click:function(e){return t.delCaptureConfirm()}}},[a("i",{staticClass:"material-icons"},[t._v("delete")])])])]),a("div",{staticClass:"uk-text-meta uk-margin-remove-top uk-padding-remove uk-width-expand"},[a("time",[t._v(t._s(t.time))])]),a("div",{staticClass:"uk-text-meta uk-margin-remove-top uk-padding-remove uk-width-auto"},[a("a",{attrs:{href:t.metadataModalTarget,"uk-toggle":""}},[t._v("More...")])])]),a("div",{staticClass:"uk-card-footer uk-padding-small"},[0!=t.openInImjoyMenuItems.length?a("button",{staticClass:"uk-icon",attrs:{type:"button"}},[a("img",{staticStyle:{width:"25px"},attrs:{src:"https://imjoy.io/static/img/imjoy-icon.svg"}})]):t._e(),a("div",{attrs:{"uk-dropdown":"pos: top-center"}},[a("ul",{staticClass:"uk-nav uk-dropdown-nav"},t._l(t.openInImjoyMenuItems,(function(e){return a("li",{key:e.name},[a("a",{attrs:{href:"#"},on:{click:function(a){return e.callback(t.name,t.imgURL)}}},[a("i",{staticClass:"material-icons"},[t._v("launch")]),t._v(t._s(e.title))])])})),0)]),t._v(" "),t._l(t.tags,(function(e){return a("div",{key:e,staticClass:"uk-display-inline"},["temporary"===e?a("span",{staticClass:"uk-label uk-label-danger uk-margin-small-right",attrs:{"uk-tooltip":"title: Capture will be removed automatically; delay: 500"}},[t._v("Temporary")]):a("span",{staticClass:"uk-label uk-margin-small-right deletable-label",on:{click:function(a){return t.delTagConfirm(e)}}},[t._v(" "+t._s(e)+" ")])])})),a("a",{attrs:{href:t.tagModalTarget,"uk-toggle":""}},[a("span",{staticClass:"uk-label uk-label-success uk-margin-small-right"},[t._v("Add")])])],2),a("div",{attrs:{id:t.metadataModalID,"uk-modal":""}},[a("div",{staticClass:"uk-modal-dialog uk-modal-body",class:{"uk-light uk-background-secondary":t.$store.state.darkMode}},[a("button",{staticClass:"uk-modal-close-default",attrs:{type:"button","uk-close":""}}),a("h2",{staticClass:"uk-modal-title"},[t._v(t._s(t.name))]),a("p",[a("b",[t._v("Path: ")]),t._v(t._s(t.path))]),a("p",[a("b",[t._v("Time: ")]),t._v(t._s(t.time))]),a("p",[a("b",[t._v("ID: ")]),t._v(t._s(t.id))]),a("p",[a("b",[t._v("Format: ")]),t._v(t._s(t.format))]),a("hr"),t._l(t.annotations,(function(e,i){return a("div",{key:i},[a("p",[a("b",[t._v(t._s(i)+": ")]),t._v(t._s(e)+" ")])])})),a("hr"),a("div",{staticClass:"uk-flex-bottom",attrs:{"uk-grid":""}},[a("div",{staticClass:"uk-width-2-3"},[a("keyvalList",{model:{value:t.newAnnotations,callback:function(e){t.newAnnotations=e},expression:"newAnnotations"}})],1),a("div",{staticClass:"uk-width-1-3"},[a("button",{staticClass:"uk-button uk-button-primary uk-form-small uk-width-1-1",on:{click:function(e){return t.handleAnnotationsSubmit()}}},[t._v(" Add annotation ")])])])],2)]),a("div",{attrs:{id:t.tagModalID,"uk-modal":""}},[a("form",{staticClass:"uk-modal-dialog uk-modal-body uk-margin-auto-vertical",class:{"uk-light uk-background-secondary":t.$store.state.darkMode},on:{submit:function(e){return e.preventDefault(),t.handleTagSubmit(e)}}},[a("div",{staticClass:"uk-inline"},[t._m(0),a("input",{directives:[{name:"model",rawName:"v-model",value:t.newTag,expression:"newTag"}],staticClass:"uk-input uk-form-width-medium uk-form-small",attrs:{autofocus:"",type:"text",name:"tagname",placeholder:"tag"},domProps:{value:t.newTag},on:{input:function(e){e.target.composing||(t.newTag=e.target.value)}}}),a("button",{staticClass:"uk-button uk-button-default uk-margin-left uk-form-small uk-modal-close",attrs:{type:"button"}},[t._v(" Cancel ")]),a("button",{staticClass:"uk-button uk-button-primary uk-margin-left uk-form-small",attrs:{type:"submit"}},[t._v(" Save ")])])])])])},c=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"uk-form-icon"},[a("i",{staticClass:"material-icons"},[t._v("label")])])}],d=(a("8e6e"),a("bd86")),m=a("8323"),p=a.n(m),v=a("2f62"),f=a("500b");function h(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function g(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?h(Object(a),!0).forEach((function(e){Object(d["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var b={name:"CaptureCard",components:{keyvalList:f["a"]},props:{id:{type:String,required:!0},name:{type:String,required:!0},time:{type:String,required:!0},path:{type:String,required:!0},format:{type:String,required:!0},links:{type:Object,required:!0},tags:{type:Array,required:!1,default:function(){return[]}},annotations:{type:Object,required:!1,default:function(){return{}}}},data:function(){return{newTag:"",newAnnotations:{}}},computed:g({tagModalID:function(){return this.makeModalName("tag-modal-")},tagModalTarget:function(){return"#"+this.tagModalID},metadataModalID:function(){return this.makeModalName("metadata-modal-")},metadataModalTarget:function(){return"#"+this.metadataModalID},thumbURL:function(){return"".concat(this.links.download.href,"?thumbnail=true")},imgURL:function(){return this.links.download.href},tagsURL:function(){return this.links.tags.href},annotationsURL:function(){return this.links.annotations.href},captureURL:function(){return this.links.self.href}},Object(v["b"])("imjoy",{openInImjoyMenuItems:"openImageMenu"})),created:function(){},methods:{getMetadata:function(){var t=this;r.a.get(this.captureURL).then((function(e){t.$emit("update:tags",e.data.metadata.image.tags),t.$emit("update:annotations",e.data.metadata.image.annotations)})).catch((function(e){t.modalError(e)}))},handleTagSubmit:function(t){""!==this.newTag&&(this.newTagRequest(this.newTag),this.newTag=""),p.a.modal(t.target.parentNode).hide()},handleAnnotationsSubmit:function(){this.putAnnotationsRequest(this.newAnnotations),this.newAnnotations={}},delCaptureConfirm:function(){var t=this;this.modalConfirm("Permanantly delete capture?").then((function(){t.delCaptureRequest()}))},delCaptureRequest:function(){var t=this;r.a.delete(this.captureURL).then((function(){t.$root.$emit("globalUpdateCaptures")})).catch((function(e){t.modalError(e)}))},newTagRequest:function(t){var e=this;r.a.put(this.tagsURL,[t]).then((function(){e.getTagRequest()})).catch((function(t){e.modalError(t)}))},putAnnotationsRequest:function(t){var e=this;r.a.put(this.annotationsURL,t).then((function(){e.getAnnotationsRequest()})).catch((function(t){e.modalError(t)}))},delTagConfirm:function(t){var e=this;this.modalConfirm("Remove tag '".concat(t,"'?")).then((function(){e.delTagRequest(t)}))},delTagRequest:function(t){var e=this;r.a.delete(this.tagsURL,{data:[t]}).then((function(){e.getTagRequest()})).catch((function(t){e.modalError(t)}))},getTagRequest:function(){var t=this;r.a.get(this.tagsURL).then((function(e){t.$emit("update:tags",e.data)})).catch((function(e){t.modalError(e)}))},getAnnotationsRequest:function(){var t=this;r.a.get(this.annotationsURL).then((function(e){t.$emit("update:annotations",e.data)})).catch((function(e){t.modalError(e)}))},makeModalName:function(t){return t+this.id}}},k=b,y=a("2877"),_=Object(y["a"])(k,u,c,!1,null,null,null),w=_.exports,C=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"capture-card uk-card uk-card-primary uk-padding-remove uk-width-medium"},[a("div",{staticClass:"uk-card-media-top"},[a("a",{attrs:{href:"#"}},[a("img",{staticClass:"uk-width-1-1",attrs:{"data-src":t.thumbnail,alt:t.id,width:"300",height:"225","uk-img":""},on:{click:t.onClick}})])]),a("div",{staticClass:"uk-card-body uk-padding-small"},[a("div",{staticClass:"uk-width-1-1 uk-margin-small uk-margin-remove-left uk-margin-remove-right",attrs:{"uk-grid":""}},[a("div",{staticClass:"uk-margin-remove-top uk-padding-remove uk-width-expand"},[a("b",[t._v(t._s(t.type)+": ")]),t._v(" "+t._s(t.name)+" ")]),a("div",{staticClass:"uk-margin-remove-top uk-padding-remove uk-width-auto"},[a("a",{staticClass:"uk-icon",attrs:{href:"#"},on:{click:function(e){return t.delAllConfirm()}}},[a("i",{staticClass:"material-icons"},[t._v("delete")])])])]),a("div",{staticClass:"uk-text-meta uk-margin-remove-top uk-padding-remove uk-width-expand"},[a("time",[t._v(t._s(t.time))])])]),a("div",{staticClass:"uk-card-footer uk-padding-small"},[0!=t.openInImjoyMenuItems.length?a("button",{staticClass:"uk-icon",attrs:{type:"button"}},[a("img",{staticStyle:{width:"25px"},attrs:{src:"https://imjoy.io/static/img/imjoy-icon.svg"}})]):t._e(),a("div",{attrs:{"uk-dropdown":"pos: top-center"}},[a("ul",{staticClass:"uk-nav uk-dropdown-nav"},t._l(t.openInImjoyMenuItems,(function(e){return a("li",{key:e.name},[a("a",{staticStyle:{color:"black"},attrs:{href:"#"},on:{click:function(a){return e.callback(t.name,t.allURLs)}}},[a("i",{staticClass:"material-icons"},[t._v("launch")]),t._v(t._s(e.title))])])})),0)]),t._v(" "),t._l(t.tags,(function(e){return a("span",{key:e,staticClass:"uk-label uk-margin-small-right deletable-label"},[t._v(" "+t._s(e)+" ")])}))],2)])},S=[];function x(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function $(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?x(Object(a),!0).forEach((function(e){Object(d["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):x(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var T={name:"ScanCard",props:{id:{type:String,required:!0},name:{type:String,required:!0},time:{type:String,required:!0},type:{type:String,required:!1,default:"Dataset"},thumbnail:{type:String,required:!0},captures:{type:Array,required:!0},tags:{type:Array,required:!1,default:function(){return[]}}},computed:$({allURLs:function(){var t=[],e=!0,a=!1,i=void 0;try{for(var n,s=this.captures[Symbol.iterator]();!(e=(n=s.next()).done);e=!0){var r=n.value;t.push(r.links.self.href)}}catch(o){a=!0,i=o}finally{try{e||null==s.return||s.return()}finally{if(a)throw i}}return t}},Object(v["b"])("imjoy",{openInImjoyMenuItems:"openScanMenu"})),methods:{onClick:function(){this.$emit("selectFolder",this.id)},delAllConfirm:function(){var t=this;this.modalConfirm("Permanantly delete all captures in this dataset?").then((function(){t.deleteAll()}))},deleteAll:function(){var t=this;r.a.all(this.allURLs.map((function(t){return r.a.delete(t)}))).then((function(){t.$root.$emit("globalUpdateCaptures")}))}}},E=T,O=Object(y["a"])(E,C,S,!1,null,null,null),P=O.exports,A=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.zipBuilderUri?a("div",{staticClass:"uk-width-small"},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.downloadReady,expression:"downloadReady"}]},[a("button",{staticClass:"uk-button uk-button-default uk-width-1-1",attrs:{disabled:t.isDownloading,type:"button"},on:{click:function(e){return t.downloadWithAxios()}}},[t._v(" "+t._s(t.isDownloading?t.downloadProgress+"%":"Download")+" ")])]),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.downloadReady,expression:"!downloadReady"}]},[t.zipBuilderUri?a("taskSubmitter",{attrs:{"can-terminate":!1,"submit-url":t.zipBuilderUri,"submit-label":"Create ZIP","submit-data":t.captureIds},on:{response:t.onResponse,error:t.modalError}}):t._e()],1)]):t._e()},j=[],I=(a("7514"),a("8357")),U={name:"ZipDownloader",components:{taskSubmitter:I["a"]},props:{captureIds:{type:Array,required:!0}},data:function(){return{downloadProgress:0,isDownloading:!1,downloadReady:!1,downloadUrl:null,zipBuilderUri:null,zipGetterUri:null,lastSessionId:null}},computed:{pluginsUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/extensions")}},mounted:function(){this.updateZipperUri()},created:function(){var t=this;this.unwatchStoreFunction=this.$store.watch((function(t,e){return e.ready}),(function(e){e&&t.updateZipperUri()}))},methods:{updateZipperUri:function(){var t=this;this.$store.state.available?r.a.get(this.pluginsUri).then((function(e){var a=e.data,i=a.find((function(t){return"org.openflexure.zipbuilder"===t.title}));i&&(t.zipBuilderUri=i.links.build.href,t.zipGetterUri=i.links.get.href)})).catch((function(e){t.modalError(e)})):(this.zipBuilderUri=null,this.zipGetterUri=null)},resetZipper:function(){this.downloadReady=!1},forceFileDownload:function(t){var e=window.URL.createObjectURL(new Blob([t.data])),a=document.createElement("a");a.href=e,a.setAttribute("download","".concat(this.lastSessionId,".zip")),document.body.appendChild(a),a.click()},downloadWithAxios:function(){var t=this,e={responseType:"blob",onDownloadProgress:function(e){t.downloadProgress=Math.floor(100*e.loaded/e.total)}};this.isDownloading=!0,r.a.get(this.downloadUrl,e).then((function(e){t.forceFileDownload(e),t.deleteLastZip(),t.resetZipper()})).catch((function(e){t.modalError(e)})).finally((function(){t.isDownloading=!1}))},deleteLastZip:function(){var t=this;r.a.delete(this.downloadUrl).catch((function(e){t.modalError(e)}))},onResponse:function(t){this.lastSessionId=t.output.id,this.downloadUrl="".concat(this.zipGetterUri,"/").concat(this.lastSessionId),this.downloadReady=!0}}},D=U,L=Object(y["a"])(D,A,j,!1,null,null,null),R=L.exports,z={name:"GalleryDisplay",components:{captureCard:w,scanCard:P,ZipDownloader:R,Paginate:l.a},data:function(){return{captures:[],checkedTags:[],sortDescending:!0,galleryFolder:"",scanTag:"scan",unwatchStoreFunction:null,maxitems:10,page:1}},computed:{capturesUri:function(){return"".concat(this.$store.getters.baseUri,"/api/v2/captures")},allTags:function(){var t=[],e=!0,a=!1,i=void 0;try{for(var n,s=this.captures[Symbol.iterator]();!(e=(n=s.next()).done);e=!0){var r=n.value,o=!0,l=!1,u=void 0;try{for(var c,d=r.tags[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var m=c.value;t.includes(m)||t.push(m)}}catch(p){l=!0,u=p}finally{try{o||null==d.return||d.return()}finally{if(l)throw u}}}}catch(p){a=!0,i=p}finally{try{e||null==s.return||s.return()}finally{if(a)throw i}}return t.sort()},noScanCaptures:function(){var t=[],e=!0,a=!1,i=void 0;try{for(var n,s=this.captures[Symbol.iterator]();!(e=(n=s.next()).done);e=!0){var r=n.value;this.isDatasetPopulated(r.dataset)||t.push(r)}}catch(o){a=!0,i=o}finally{try{e||null==s.return||s.return()}finally{if(a)throw i}}return t},allScans:function(){var t={},e=!0,a=!1,i=void 0;try{for(var n,s=this.captures[Symbol.iterator]();!(e=(n=s.next()).done);e=!0){var r=n.value,o=r.dataset;if(this.isDatasetPopulated(o)){var l=o["id"];l in t||(t[l]={},t[l].id=l,t[l].name=o.name,t[l].type=o.type,t[l].time=r.time,t[l].isScan=!0,t[l].captures=[],t[l].tags=[]),t[l].captures.push(r);var u=!0,c=!1,d=void 0;try{for(var m,p=r.tags[Symbol.iterator]();!(u=(m=p.next()).done);u=!0){var v=m.value;t[l].tags.includes(v)||t[l].tags.push(v)}}catch(f){c=!0,d=f}finally{try{u||null==p.return||p.return()}finally{if(c)throw d}}"thumbnail"in t[l]||(t[l].thumbnail="".concat(r.links.download.href,"?thumbnail=true"))}}}catch(f){a=!0,i=f}finally{try{e||null==s.return||s.return()}finally{if(a)throw i}}return t},scanList:function(){return Object.values(this.allScans)},itemList:function(){return this.galleryFolder?this.allScans[this.galleryFolder].captures:this.noScanCaptures.concat(this.scanList)},filteredItems:function(){return this.filterCaptures(this.itemList,this.checkedTags)},filteredCaptures:function(){var t={},e=!0,a=!1,i=void 0;try{for(var n,s=this.filteredItems[Symbol.iterator]();!(e=(n=s.next()).done);e=!0){var r=n.value;if("captures"in r){var o=!0,l=!1,u=void 0;try{for(var c,d=r.captures[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var m=c.value;t[m.id]=m}}catch(p){l=!0,u=p}finally{try{o||null==d.return||d.return()}finally{if(l)throw u}}}else t[r.id]=r}}catch(p){a=!0,i=p}finally{try{e||null==s.return||s.return()}finally{if(a)throw i}}return t},sortedItems:function(){return this.sortCaptures(this.filteredItems)},pagedItems:function(){var t=(this.page-1)*this.maxitems;return this.sortedItems.slice(t,t+this.maxitems)},numberOfPages:function(){return Math.floor(this.sortedItems.length/this.maxitems)}},mounted:function(){var t=this;this.updateCaptures(),this.$root.$on("globalUpdateCaptures",(function(){t.updateCaptures()}))},created:function(){var t=this;this.unwatchStoreFunction=this.$store.watch((function(t,e){return e.ready}),(function(e){e?t.updateCaptures():t.captures={}}))},beforeDestroy:function(){this.$root.$off("globalUpdateCaptures"),this.unwatchStoreFunction&&(this.unwatchStoreFunction(),this.unwatchStoreFunction=null)},methods:{scrollToTop:function(){var t=document.querySelector("#container-left");t&&(t.scrollTop=0)},updateCaptures:function(){var t=this;this.$store.state.available&&r.a.get(this.capturesUri).then((function(e){t.captures=e.data})).catch((function(e){t.modalError(e)}))},isDatasetPopulated:function(t){return!(!t||t.constructor===Object&&0===Object.keys(t).length)},filterCaptures:function(t,e){var a=[],i=!0,n=!1,s=void 0;try{for(var r,o=t[Symbol.iterator]();!(i=(r=o.next()).done);i=!0){var l=r.value,u=!1,c=l.tags,d=function(t,e){return e.every((function(e){return t.includes(e)}))};u=d(c,e),1==u&&a.push(l)}}catch(m){n=!0,s=m}finally{try{i||null==o.return||o.return()}finally{if(n)throw s}}return a},sortCaptures:function(t){function e(t,e){return t.time<e.time?-1:t.time>e.time?1:0}return 1==this.sortDescending?t.sort(e).reverse():t.sort(e)},galleryBack:function(){this.galleryFolder="",this.page=1},selectFolder:function(t){this.galleryFolder=t}}},M=z,N=(a("7e89"),Object(y["a"])(M,i,n,!1,null,"0892d90f",null));e["default"]=N.exports},b498:function(t,e,a){},b9e4:function(t,e,a){"use strict";a("b498")},bacb:function(t,e,a){},d10d:function(t,e,a){"use strict";a("e49d")},d271:function(t,e,a){"use strict";a("7294")},d3b6:function(t,e,a){},d581:function(t,e,a){"use strict";a("642d")},dcc1:function(t,e,a){},e324:function(t,e,a){},e49d:function(t,e,a){},f62e:function(t,e,a){"use strict";a("dcc1")},fc7f:function(t,e,a){}});
//# sourceMappingURL=app.9cf20d05.js.map